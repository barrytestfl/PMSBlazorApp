var i={79:function(){function s(e,t){var i,o,r;if(e==g.InProgress||e==y.InProgress)i='<svg class="icon-ic-refresh rotateClockwise"><use href="#icon-ic-refresh"></use></svg>',o=p.resources.cloneStatusResult.InProgress,r="cloning";else if(e==g.PartiallyCloned&&null==t)i='<svg class="icon-ic-warning orange"><use href="#icon-ic-warning"></use></svg>',o=p.resources.cloneStatusResult.PartiallyCloned,r="warning";else{if(e==g.PartiallyCloned&&null!=t)return'<button class="btn-table_primary btn-table_primary-large s-cloneRetry" '+(t=null!=t?"data-retry='"+JSON.stringify(t)+"'":t)+">"+p.resources.retryButton+"</button>";if(e!=g.Failed&&e!=y.Failure&&e!=y.DuplicateFailure||null!=t){if((e==g.Failed||e==y.Failure||e==y.DuplicateFailure)&&null!=t)return'<button class="btn-table_primary btn-table_primary-large s-cloneRetry" '+(t=null!=t?"data-retry='"+JSON.stringify(t)+"'":t)+">"+p.resources.retryButton+"</button>";if(e!=g.Cloned&&e!=y.Success)return"";i='<svg class="icon-ic-checkmark-small"><use href="#icon-ic-checkmark-small"></use></svg>',o=p.resources.cloneStatusResult.Cloned,r="success"}else i='<svg class="icon-ic-warning red"><use href="#icon-ic-warning"></use></svg>',o=p.resources.cloneStatusResult.Failed,r="error"}return'<div class="status '+r+' display-inline-flex align-items-center ml-auto">'+i+"<span>"+o+"</span></div>"}function r(){""!=v&&"number"==typeof v?eviivo.webcore.ajaxHelper.executeAjax({actionId:"CloneRefreshTargetLevelStatusStatus",url:"".concat(eviivoSuiteApp,"/api/clone/refreshTargetLevelStatus?cloneRequestId=").concat(v,"&businessId=").concat(p.businessId),method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){null!=e&&(t(e),eviivo.webcore.ajaxHelper.executeAjax({actionId:"CloneRefreshItemLevelStatusStatus",url:"".concat(eviivoSuiteApp,"/api/clone/refreshItemLevelStatus?cloneRequestId=").concat(v,"&businessId=").concat(p.businessId),method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){null!=e&&t(e)}}))}}):(console.error("please provide a valid request Id"),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage}))}function t(e){for(var t,i=!1,o=0;o<e.length;o++)0==e[o].ItemId?(l(e[o].Result,e[o].TargetId),null!=e[o].Reason&&(t=$("div[data-id="+e[o].TargetId+"] .mod-collapsable_title").find("div.status"),eviivo.webcore.tooltip.add(t,e[o].Reason,"bottom")),e[o].Result==g.InProgress&&(i=!0)):(t={cloneRequestId:v,TargetId:e[o].TargetId,ItemId:e[o].ItemId,ItemType:e[o].ItemType},c(e[o].Result,e[o].TargetId,e[o].ItemId,e[o].Reason,t));n(),1==i&&setTimeout(r,1e3*f)}function n(){eviivo.component.handlers.assign(h.retryBtn,a,"click");for(var e,t,i,o=document.getElementsByTagName("table"),r=0;r<o.length;r++)1<o[r].querySelectorAll(".s-cloneRetry").length?(e=o[r].querySelector("th[data-key=Status]").cellIndex+1,e=o[r].querySelector("tr:first-child th:nth-child("+e+")"),0==o[r].querySelectorAll(".s-cloneRetryAll").length&&(t={cloneRequestId:v,TargetId:o[r].closest(".s-property-selection").dataset.id,ItemId:null,ItemType:null},(i=document.createElement("button")).setAttribute("type","button"),i.innerHTML=p.resources.retryAllButton,i.setAttribute("class","s-cloneRetryAll btn-table_primary btn-table_primary-large"),i.dataset.retry=JSON.stringify(t),e.appendChild(i),eviivo.component.handlers.assign(".s-cloneRetryAll",a,"click"))):0<o[r].querySelectorAll(".s-cloneRetryAll").length&&o[r].querySelectorAll(".s-cloneRetryAll")[0].remove()}function a(){var e=$(this).data("retry");eviivo.webcore.ajaxHelper.executeAjax({actionId:"CloneRetryRequest",url:eviivoSuiteApp+"/api/clone/SubmitRetry",data:e,method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){}}),l(g.InProgress,e.TargetId),c(g.InProgress,e.TargetId,e.ItemId,"",null),setTimeout(r,1e3*f)}function l(e,t){$("div[data-id="+t+"] .mod-collapsable_title").find("div.status").remove();t=$("div[data-id="+t+"]").find("span:first");$(s(e,null)).insertAfter(t)}function c(e,t,i,o,r){var n;null!=i?(d==m.CALENDAR&&(i=t),(n=$("div[data-id="+t+"]").find("table")).find("tr[data-id='"+i+"']>td.details").html($("<p/>").html(o).text()),n.find("tr[data-id='"+i+"']>td.status").html(s(e,r)),0==$("div[data-id="+t+"]").find(".s-cloneRetry").length&&$("div[data-id="+t+"]").find(".s-cloneRetryAll").remove()):((n=$("div[data-id="+t+"]").find("table")).find("tr>td.details").html(o),n.find("tr>td.status").html(s(e,r)),$("div[data-id="+t+"]").find(".s-cloneRetryAll").remove())}function i(){for(var e=document.getElementsByClassName("s-expand-btn"),t=e[0].innerHTML==p.resources.collapseAll?(e[0].innerHTML=p.resources.expandAll,!0):(e[0].innerHTML=p.resources.collapseAll,!1),i=document.querySelectorAll(".s-property-selection"),o=1;o<=i.length;o++)document.querySelector("#property_location_"+o).checked=t}function u(){var e;null!=o&&(e=$(".cp-custom-select")[0],$(e).val(o).trigger("click"),o=null)}var d,v,o,p,m,g,y,h,f;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.clone=window.eviivo.pms.clone||{},window.eviivo.pms.clone.history=window.eviivo.pms.clone.history||{},window.eviivo.pms.clone.history=(p={},m={ROOM:1,CALENDAR:2,DEPOSITS:3,RATE:4},g={InProgress:1,PartiallyCloned:2,Failed:3,Cloned:4},y={Success:"SUC",Failure:"FAI",DuplicateFailure:"DUP",InProgress:"INP"},h={backBtn:"#btn-back",cancelBtn:"#btn-cancel",nextBtn:"#btn-next",doneBtn:"#btn-done",retryBtn:".s-cloneRetry"},f=30,{init:function(){o=$(this).closest("tr").find("td:first-child")[0].innerText,eviivo.component.flyout.showFlyout("displayHistoryContainer")},optionsSetup:function(e){p=eviivo.util.extend(p,e),d=p.typeId,v=p.cloneRequestId,f=p.refreshRate},onShow:function(){$.fn.dataTable.isDataTable("#eviivo-list-history")?$("#eviivo-list-history").DataTable().ajax.reload(u,!0):"function"==typeof postInitListingTable&&postInitListingTable()},customRenderAction:function(e,t,i){return'<a href="'+eviivoSuiteApp+"/Settings/Clone/Status/"+i.Id+'" target="_blank" class="md-table_action md-table_action-item"><svg class="icon-bg-eye-outline"> <use  href="#icon-bg-eye-outline"></use></svg></a>'},customRenderDateTime:function(e,t,i){return'<div class="history-date">'+(e=new Date(e)).evDisplayLongDate(eviivo.eagle.basePageModelState.userCultureCode)+',</div><div class="history-time">'+e.evDisplayLongTime(eviivo.eagle.basePageModelState.userCultureCode)+"</div>"},customRenderResult:function(e,t,i){return s(e,null)},reasonCustomRender:function(e,t,i){return null!=e?"<strong>"+e+"</strong>":""},statusCustomRender:function(e,t,i){return s(e,null)},refreshStatus:r,loadSuccess:n,filterSetup:function(){$(".cp-custom-select").find("option").remove(),$(".cp-custom-select").off("change");for(var e=$(".cp-custom-select")[0],i=$(".cp-custom-select")[1],t=($(e).append("<option value=''>"+p.resources.filterSelectAll+"</option>"),$(i).append("<option value=''>"+p.resources.filterSelectAll+"</option>"),$("#clone-table").find("tr>td:first-child")),o=0;o<t.length;o++)$(e).append("<option value='"+t[o].innerHTML+"'>"+t[o].innerHTML+"</option>");$.each(p.resources.cloneStatusResult,function(e,t){$(i).append("<option value='"+t+"'>"+t+"</option>")}),$(e).on("click",function(){var e=$(".cp-custom-select > option:selected")[0].value;$("#eviivo-list-history").DataTable().search(e,!0,!0).draw()}),$(i).on("click",function(){var e=$(".cp-custom-select > option:selected")[1].value;$("#eviivo-list-history").DataTable().search(e,!0,!0).draw()}),u()},actionCustomRender:function(e,t,i){return""},setupCollapseExpandBtn:function(){var e,t;1<p.noOfTargets&&(e=document.querySelector(".page-heading div.h2"),(t=document.createElement("button")).setAttribute("type","button"),t.setAttribute("name",p.resources.expandAll),t.setAttribute("value",p.resources.expandAll),t.innerHTML=p.resources.expandAll,t.setAttribute("class","s-expand-btn btn-table_primary btn-table_primary-large btn-target-collapse"),e.appendChild(t),eviivo.component.handlers.assign(".s-expand-btn",i,"click"))},setupRefreshInterval:function(){setTimeout(r,f)},getCloningStatusTypes:function(){return g}})},2679:function(){function i(){eviivo.component.flyout.hideFlyout(n.flyout.replace("#",""))}function o(e){e?$(n.flyout).find(n.flyoutSpinner).removeClass("hide"):$(n.flyout).find(n.flyoutSpinner).addClass("hide")}function r(e){$(n.flyout).find(n.bodyContainer).html(e),o(!1),""!=e&&(t("".concat($(n.cloneHiddenTitle).html())),postInitComplete())}function t(e){$(n.flyout).find(n.header).html(e)}var n,s,a;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.clone=window.eviivo.pms.clone||{},window.eviivo.pms.clone.statusFlyout=(n={flyout:"#clone-status",header:".s-heading-title",flyoutSpinner:".s-flyout-spinner",cloneHiddenTitle:".s-flyout-title",bodyContainer:"#cloneStatusContainer"},s=0,a={},{init:function(e){a=eviivo.util.extend(a,e)},open:function(e,t){o(!0),eviivo.component.flyout.showFlyout(n.flyout),e=e,t=t,eviivo.webcore.ajaxHelper.executeAjax({actionId:"get-clone-status",url:"".concat(eviivoSuiteApp,"/clone/status/flyout/business/").concat(e,"/clone/").concat(t),method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){null!=e.Errors?(i(),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})):r(e.HtmlPayload)},failCallback:function(){i(),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}})},close:i,flyoutOnShow:function(){},flyoutOnClose:function(){null!=eviivo.pms.pricingRules&&eviivo.pms.pricingRules.createFlyout.close(),r(""),t("")},statusCustomRender:function(e,t,i){return""!=(e=eviivo.pms.clone.history.customRenderResult(e,t,i))?(null!=i.CloneErrorMsg&&eviivo.webcore.tooltip.add(e,i.CloneErrorMsg,"top"),$(e).addClass("cp-table_action cp-table_action-item").prop("outerHTML")):""},scheduleMainTableRefreshIfStatusInProgressExists:function(e,t){0<$("".concat(e," .status.cloning")).length&&(setTimeout(t,a.cloningRefreshRate*s),s+=1)},resetRefreshOccurrences:function(){s=0}})},7887:function(){function r(e,t){t=$("#".concat(e," th:eq(").concat(t,")")).attr("data-key");return $.each(n,function(){this.tableId.toLowerCase()==e.toLowerCase()&&(cachedTableColumnCodesMap=this.columnCodes)}),cachedTableColumnCodesMap[t]}var n,s,a,l;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.listingTable=window.eviivo.pms.listingTable||{},window.eviivo.pms.listingTable.filterActions=window.eviivo.pms.listingTable.filterActions||{},window.eviivo.pms.listingTable.filterActions=(n=[{tableId:"eviivo-list-rule",tableCode:"PRL",columnCodes:{PropertyName:"PRO",TypeCodeDescription:"RTY",Name:"RNA",RoomTypeName:"APP",ChannelsFilter:"CHA",Status:"STA",UpdateStatus:"UST"}},{tableId:"eviivo-list-cutoff",tableCode:"BCO",columnCodes:{PropertyName:"BPR",Description:"BCD",Status:"BST"}},{tableId:"eviivo-list-cleaning",tableCode:"CLN",columnCodes:{Unit:"CRO",Movement:"CMO",Condition:"CCO",Schedule:"CSH",Assigned:"CAT",BedConfig:"CBE",Property:"CPR"}},{tableId:"eviivo-list-charge",tableCode:"GCH",columnCodes:{PropertyName:"GPR",Name:"GCN",CategoryName:"GCA",DisplayOnline:"GDO",CollectionMethodDisplay:"GCO"}},{tableId:"eviivo-list-ownercharge",tableCode:"OCH",columnCodes:{PropertyName:"OPR",Name:"OCN",CategoryName:"OCA"}},{tableId:"eviivo-list-deductions",tableCode:"DED",columnCodes:{BusinessName:"DEP",Name:"DEN",Category:"DEC",Apply:"DEA",Pricing:"DDP"}},{tableId:"eviivo-list-categories",tableCode:"CCA",columnCodes:{BusinessName:"CCP",Category:"CCC",Code:"CCO",AssociatedTemplates:"CCA"}},{tableId:"eviivo-list-promotion",tableCode:"PRO",columnCodes:{BusinessName:"PRP",Name:"PPR",Type:"PRT",DiscountRules:"PDI",BookingWindow:"PWI",Status:"PST"}},{tableId:"eviivo-list-ratemap",tableCode:"RML",columnCodes:{BusinessName:"RMP",RoomTypeName:"RMR",RatePlanName:"RRP",Status:"RMS",Guests:"RMC",MaxAdults:"RMA",MaxChildren:"RMK",BoardBasis:"RMB",Cancellation:"RMN",Deposit:"RMD",Channels:"RMH"}},{tableId:"eviivo-list-reports",tableCode:"DRT",columnCodes:{Name:"DRN"}},{tableId:"eviivo-list-rateplans",tableCode:"CRS",columnCodes:{Status:"CRS",Channels:"CRC",RoomType:"CRR",RatePlan:"CRP",Notes:"CRN"}},{tableId:"eviivo-list-emails",tableCode:"MTL",columnCodes:{PropertyName:"MTP",GuestCycle:"MTC",EmailType:"MTT",Description:"MTD",Schedule:"MTS",Status:"MTA"}},{tableId:"eviivo-list-headers",tableCode:"HML",columnCodes:{PropertyName:"HPC",Universal:"HUC",HomePage:"HHC",WebPage:"HWC",Emails:"HEC",Invoice:"HIC",GuestRegistration:"HGC"}},{tableId:"eviivo-list-bookings",tableCode:"ATL",columnCodes:{BusinessName:"ATP",GuestSurname:"ATG",RoomName:"ATR",NumberOfNights:"ATN",Source:"ATS",IsMarkedBool:"ATH"}},{tableId:"eviivo-list-agreementtemplate",tableCode:"ATT",columnCodes:{TemplateName:"ATN",AppliesTo:"ATA"}},{tableId:"eviivo-list-agreement",tableCode:"AGT",columnCodes:{PropertyName:"AGP",AgreementDisplayName:"AGN",SignatureFirstName:"AGF",SignatureSurname:"AGS",OrderReference:"AGO",OrderCheckInPropertyDate:"AGC",AgreementSentPropertyDateTime:"AGS",SignaturePropertyDateTime:"AGX",Status:"AGA"}}],s=[],a="ATL",l="ATH",{init:function(e){var t,i,o,r;o=e.table,$.each(n,function(){this.tableId.toLowerCase()==o.toLowerCase()&&(r=this.tableCode)}),t=r,i=e.callback,eviivo.webcore.ajaxHelper.executeAjax({actionId:"get-listingtable-filter-data-".concat(t),url:"".concat(eviivoSuiteApp,"/api/UserPreferenceListingTableFilterActions/get?tableCode=").concat(t),method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){s=s.concat(e),(e=t)==a&&(null==(e=null==(e=s)?void 0:e.filter(function(e){return e.Key==l}))||0==e.length?s.push({PreferenceGroupType:a,Key:l,Value:'["false"]'}):null!=e&&"[]"==e[0].Value&&(e[0].Value='["false"]')),i()},failCallback:function(){i()}})},get:function(e,t){var i=r(e,t),o=null;return $.each(s,function(){this.Key==i&&(o=this.Value)}),null==o?"":(o=o.replaceAll("&quot;",'"'),JSON.parse(o))},post:function(e,t){var e=e.parents("table").attr("id"),i=eviivo.component.listing.filter.getColumnSearchStrings(e,t),e=r(e,t);eviivo.webcore.ajaxHelper.executeAjax({actionId:"post-listingtable-filter-".concat(e),url:"".concat(eviivoSuiteApp,"/api/UserPreferenceListingTableFilterActions/post"),data:{ColumnCode:e,ColumnFilter:JSON.stringify(i)},method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){}})}})},1452:function(){var n,s;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.listingTable=window.eviivo.pms.listingTable||{},window.eviivo.pms.listingTable.orderActions=window.eviivo.pms.listingTable.orderActions||{},window.eviivo.pms.listingTable.orderActions=(n=[{tableId:"eviivo-list-rule",Order:"SRT"},{tableId:"eviivo-list-cutoff",Order:"BOR"},{tableId:"eviivo-list-cleaning",Order:"COR"},{tableId:"eviivo-list-charge",Order:"GOR"},{tableId:"eviivo-list-ownercharge",Order:"OOR"},{tableId:"eviivo-list-deductions",Order:"DEO"},{tableId:"eviivo-list-categories",Order:"CCS"},{tableId:"eviivo-list-promotion",Order:"POR"},{tableId:"eviivo-list-ratemap",Order:"RMO"},{tableId:"eviivo-list-reports",Order:"DRO"},{tableId:"eviivo-list-rateplans",Order:"RSO"},{tableId:"eviivo-list-emails",Order:"MTO"},{tableId:"eviivo-list-headers",Order:"HLO"},{tableId:"eviivo-list-bookings",Order:"ATO"},{tableId:"eviivo-list-agreementtemplate",Order:"ATD"},{tableId:"eviivo-list-agreement",Order:"AGD"}],s={},{post:function(e,t){var i,o,r=eviivo.util.getJSId($(this)[0].container);null!=r&&null!=t&&isNaN(t)&&(t={ColumnCode:(i=r,$.each(n,function(){this.tableId.toLowerCase()==i.toLowerCase()&&(o=this.Order)}),o),Order:JSON.stringify(t)})!=s&&(s=t,eviivo.webcore.ajaxHelper.executeAjax({actionId:"post-listingtable-order",url:"".concat(eviivoSuiteApp,"/api/UserPreferenceListingTableFilterActions/order-post"),data:t,method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){}}))}})},8381:function(){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e(e,t,i){(t=function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);i=i.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}function i(e){e.preventDefault(),eviivo.pms.pricingRules.bulkFlyout.validation.isFormValid()&&(function(e,t,i){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;null==o&&(o=eviivo.webcore.notifier.positions.topLeft);eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.info,style:eviivo.webcore.notifier.styles.withTwoActions,message:t,autoHide:!1,buttonTwo:c.resources.proceed,buttonOne:c.resources.cancel,selector:e,position:o}),$(l.notifierBtnOne).addClass("btn btn-secondary"),$(l.notifierBtnTwo).addClass("btn btn-right ".concat(i))}($(this),c.resources.confirmText,"btn-confirm",eviivo.webcore.notifier.positions.topRight),$("body").on("click",l.confirmBtn,t))}function t(){eviivo.pms.pricingRules.bulkFlyout.validation.isFormValid()&&eviivo.webcore.ajaxHelper.executeAjax({actionId:"bulk-update-pricing-rule-save",url:"".concat(eviivoSuiteApp,"/api/pricingrules/bulk"),data:{SelectedRules:eviivo.pms.pricingRules.listing.getSelectedRules(),Name:$(l.formSelector.name).val(),StartDate:""!=$("#txtCloseoutRuleStartDate").val()?$("#txtCloseoutRuleStartDate").datepicker("getDate").evStandardIso8601DateExtended():null,EndDate:""!=$("#txtCloseoutRuleEndDate").val()?$("#txtCloseoutRuleEndDate").datepicker("getDate").evStandardIso8601DateExtended():null,ThresholdLimit:$("#thresholdLimit").val(),IncreaseDecreaseType:$(".s-increase-decrease-select:visible").val(),IncreasePricePercentThresholdLimit:$("#increasePricePercentThresholdLimit").val(),DecreasePricePercentThresholdLimit:$("#decreasePricePercentThresholdLimit").val(),IncreasePricePercent:eviivo.webcore.decimals.fixDecimalSymbolSave($("#increasePricePercent").val(),","),DecreasePricePercent:eviivo.webcore.decimals.fixDecimalSymbolSave($("#decreasePricePercent").val(),","),IncreaseInventoryPricingRuleTypeSelected:$("#increaseInventoryPricingRuleTypeSelected").val(),DecreaseInventoryPricingRuleTypeSelected:$("#decreaseInventoryPricingRuleTypeSelected").val(),ChannelType:$('input[name="ChannelType"]:checked').val(),ChannelIds:eviivo.component.twoColumnListAssignment.getSelectedSortableItems($("#closeoutRule-availableChannels"))},method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){e?(eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.success,message:eviivo.eagle.translations.resources.notify.saveSuccessText}),r(),eviivo.pms.pricingRules.listing.load(!0)):eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})},failCallback:function(){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}})}function r(){eviivo.component.flyout.hideFlyout(l.flyout.replace("#",""))}function n(e){e?$(l.flyout).find(l.flyoutSpinner).removeClass("hide"):$(l.flyout).find(l.flyoutSpinner).addClass("hide")}function s(e){n(!1),$(l.flyout).find(l.ruleContainer).html(e)}var a,l,c,u;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.bulkFlyout=(e(a={listTable:"#eviivo-list-rule",flyout:"#view-pricing-rule",body:".s-container-body",ruleContainer:"#manageRuleContainer",header:".s-heading-title",flyoutSpinner:".s-flyout-spinner",save:".s-save",form:"#frmManageCloseoutRules",saveToBtn:"#save-to",statusSection:"#status-section",formSelector:{name:"#closeoutRuleName"}},"saveToBtn","#save-to"),e(a,"confirmBtn",".btn-confirm"),e(a,"notifierBtnOne",".btn-one"),e(a,"notifierBtnTwo",".btn-two"),l=a,{init:function(e){c=eviivo.util.extend(c,e)},open:function(e){u.set=!0,e=e;var t="".concat(c.resources.bulkHeader.format(eviivo.pms.pricingRules.listing.getSelectedRules().length));$(l.flyout).find(l.header).html(t),n(!0),eviivo.component.flyout.showFlyout(l.flyout),eviivo.webcore.ajaxHelper.executeAjax({actionId:"bulk-update-pricing-rule",url:"".concat(eviivoSuiteApp,"/pricingrules/bulk"),data:e,method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){s(e.HtmlPayload),$(l.statusSection).remove(),$("#txtCloseoutRuleStartDate").val(""),$("#txtCloseoutRuleEndDate").val(""),$("#hdnCloseoutRuleStartDate").val(""),$("#hdnCloseoutRuleEndDate").val(""),$("#thresholdLimit").val(""),$("#increasePricePercentThresholdLimit").val(""),$("#decreasePricePercentThresholdLimit").val(""),$("#increasePricePercent").val(""),$("#decreasePricePercent").val(""),$("#selectRoomTypes").parent().remove(),$('input[name="ChannelType"]').prop("checked",!1),$("#customChannelsWidget").addClass("hide"),$(l.flyout).off("click",l.save).on("click",l.save,i)},failCallback:function(){r(),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}}),0<(t=$(l.saveToBtn)).length&&t.addClass("hide")},close:r,flyoutOnShow:function(){},flyoutOnClose:function(){u.set=!1,s("")},isActive:u={value:!(c={}),get get(){return this.value},set set(e){this.value=e}}})},5758:function(){function v(e,t,i){e=e.replace("#","");var o=y.validationSummary.find("#error-"+e);0===o.length?!0!==t?(o=r('<li id="error-'+e+'"><label class="error" for="'+e+'" style="display: inline;"></label></li>')).appendTo(y.validationSummary):o=null:t&&(o.remove(),o=null),null!=o&&(o=o.find("label")).html(i),0<y.validationSummary.find("li").length?y.validationSummary.parent().show():y.validationSummary.parent().hide()}function p(){var e=!0;return y.thresholdLimitMessage.parent().removeClass("error"),y.closeBetweenDatesMessage.parent().removeClass("error"),y.closeInventory.is(":checked")&&1!=(e=y.thresholdLimitRadio.is(":checked")||y.closeBetweenDatesRadio.is(":checked"))&&(y.thresholdLimitMessage.parent().addClass("error"),y.closeBetweenDatesMessage.parent().addClass("error")),v(g.closeInventory,e,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.CloseInventory),e}var r,m,g,y,h,f;window.eviivo=window.eviivo||{},window.eviivo.eagle=window.eviivo.eagle||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.bulkFlyout=window.eviivo.pms.pricingRules.bulkFlyout||{},window.eviivo.pms.pricingRules.bulkFlyout.validation=(g={closeoutRuleName:"#closeoutRuleName",validationSummary:"#closeout-validation-summary ul"},y={},h=/^((?!0\.\s,\t\n\r)[1-9])*$|^[1-9]+[0-9]*$/i,f=/^[\w0-9\-_\+\.,:;%\?\!|\(\) =&]{3,}/i,{init:function(e){if("function"!=typeof jQuery)throw"eviivo.eagle.closeoutRule.manage.validation: module depends on jQuery";m=(r=jQuery).extend({},e),y=r.extend({},y,e.elements),g=r.extend({},g,e.selectors),y.closeoutRuleName=r(g.closeoutRuleName),y.validationSummary=r(g.validationSummary),eviivo.webcore.decimals.restrictFieldsForNumbers(y.thresholdLimit),eviivo.webcore.decimals.restrictFieldsForNumbers(y.increasePricePercentThresholdLimit),eviivo.webcore.decimals.restrictFieldsForNumbers(y.decreasePricePercentThresholdLimit),eviivo.webcore.decimals.restrictFieldsForDecimals(y.decreasePricePercent),eviivo.webcore.decimals.restrictFieldsForDecimals(y.increasePricePercent)},isFormValid:function(){var e,t,i,o,r,n,s,a,l,c,u,d;return e=!0,$("#frmManageCloseoutRules input:visible").each(function(){""!=$(this).val()&&(e=!1)}),0<$('input[name="ChannelType"]:checked').length&&(e=!1),v("emptyFormValidation",!(e=$("#customChannels").is(":checked")&&0<eviivo.component.twoColumnListAssignment.getSelectedSortableItems($("#closeoutRule-availableChannels")).length?!1:e),eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.BulkEditBlankFormValidationMsg),!e&&(t=!0,y.closeoutRuleName.removeClass("error"),null!=y.closeoutRuleName.val()&&""!==y.closeoutRuleName.val().trim()&&1!=(t=f.test(y.closeoutRuleName.val()))&&y.closeoutRuleName.addClass("error"),v(g.closeoutRuleName,t,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.Name),t=t,i=p(),o=p(),r=!0,y.thresholdLimit.removeClass("error"),!0===o&&y.thresholdLimitRadio.is(":checked")&&1!=(r=h.test(y.thresholdLimit.val()))&&y.thresholdLimit.addClass("error"),v(g.thresholdLimit,r,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),o=r,r=p(),n=!0,y.txtCloseoutRuleStartDate.removeClass("error"),y.txtCloseoutRuleEndDate.removeClass("error"),!0===r&&y.closeBetweenDatesRadio.is(":checked")&&(""==y.hdnCloseoutRuleStartDate.val()&&""!=y.hdnCloseoutRuleEndDate.val()&&(y.txtCloseoutRuleStartDate.addClass("error"),v(g.txtCloseoutRuleStartDate,n=!1,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.DateRange)),""!=y.hdnCloseoutRuleStartDate.val()&&""==y.hdnCloseoutRuleEndDate.val()&&(y.txtCloseoutRuleEndDate.addClass("error"),v(g.txtCloseoutRuleEndDate,n=!1,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.DateRange)),n)&&(v(g.txtCloseoutRuleStartDate,n,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.DateRange),v(g.txtCloseoutRuleEndDate,n,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.DateRange)),r=n,n=!0,y.lblChannelType.removeClass("error"),y.widgetSortableRightColumn.removeClass("error"),y.customChannels.is(":checked")&&1!=(n=null!=m.selectedSpecificChannels()&&0<m.selectedSpecificChannels().length)&&(y.lblChannelType.addClass("error"),y.widgetSortableRightColumn.addClass("error")),v(g.lblChannelType,n,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.CustomChannels),n=n,s=!0,y.increasePricePercentThresholdLimit.removeClass("error"),y.decreasePricePercentThresholdLimit.removeClass("error"),y.increasePrice.is(":checked")&&("increase"==$(".s-increase-decrease-select:visible").val()&&1!=(s=h.test(y.increasePricePercentThresholdLimit.val()))&&y.increasePricePercentThresholdLimit.addClass("error"),"decrease"==$(".s-increase-decrease-select:visible").val())&&1!=(s=h.test(y.decreasePricePercentThresholdLimit.val()))&&y.decreasePricePercentThresholdLimit.addClass("error"),v(g.increasePricePercentThresholdLimit,s,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),s=s,u=!0,c="",a=y.increaseInventoryPricingRuleTypeSelected.val(),l=y.increasePricePercent.val().replace(",","."),y.increaseInventoryPricingRuleTypeSelected.removeClass("error"),"increase"==$(".s-increase-decrease-select:visible").val()&&"percentage"==a.toLowerCase()&&100<Globalize.parseNumber(l)&&(y.increaseInventoryPricingRuleTypeSelected.addClass("error"),c=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceIncreasePercentage,u=!1),v(g.increaseInventoryPricingRuleTypeSelected,u,c),a=u,l=!0,c="",u=y.decreaseInventoryPricingRuleTypeSelected.val(),d=y.decreasePricePercent.val().replace(",","."),y.decreaseInventoryPricingRuleTypeSelected.removeClass("error"),"decrease"==$(".s-increase-decrease-select:visible").val()&&"percentage"==u.toLowerCase()&&100<Globalize.parseNumber(d)&&(y.decreaseInventoryPricingRuleTypeSelected.addClass("error"),c=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceDecreasePercentage,l=!1),v(g.decreaseInventoryPricingRuleTypeSelected,l,c),t)&&i&&o&&r&&n&&s&&a&&l}})},2836:function(){function t(){eviivo.webcore.ajaxHelper.executeAjax({actionId:"bulk-status-update-pricing-rule",url:"".concat(eviivoSuiteApp,"/api/pricingrules/bulk-status"),data:{SelectedRules:eviivo.pms.pricingRules.listing.getSelectedRules(),IsActive:$(o.activeRadio).is(":checked")},method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){e?(i(),eviivo.pms.pricingRules.listing.load(!0)):eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})},failCallback:function(){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}})}function i(){eviivo.component.flyout.hideFlyout(o.flyout.replace("#",""))}var o,r;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.bulkStatusFlyout=(o={flyout:"#bulk-status-pricing-rule",header:".s-heading-title",save:".s-save",listTable:"#eviivo-list-rule",activeRadio:"#bulk-status-active"},r={},{init:function(e){r=eviivo.util.extend(r,e),$(o.flyout).on("click",o.save,t)},open:function(){var e;e="".concat(r.resources.bulkHeader.format(eviivo.pms.pricingRules.listing.getSelectedRules().length)),$(o.flyout).find(o.header).html(e),eviivo.component.flyout.showFlyout(o.flyout)},close:i,flyoutOnShow:function(){},flyoutOnClose:function(){eviivo.pms.pricingRules.createFlyout.close()}})},4369:function(){function e(){eviivo.component.listing.validateSingleSelectForList(t.propertyList)&&eviivo.pms.pricingRules.editFlyout.open()}var t;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.createFlyout=(t={flyout:"#create-pricing-rule-property-selection",save:".s-save",propertyList:"#eviivo-list-property"},{init:function(){$(t.flyout).on("click",t.save,e)},open:function(){eviivo.component.listing.postInitRefreshDataTableSpecific(t.propertyList),eviivo.component.flyout.showFlyout(t.flyout)},close:function(){0<$(t.flyout).length&&eviivo.component.flyout.hideFlyout(t.flyout.replace("#",""))},flyoutOnShow:function(){},flyoutOnClose:function(){},lookupCustomRender:function(e){return"<div id='".concat(e.BusinessId,"'>").concat(e.BusinessName,"</div>")},lookupRowSelection:function(e,t){var i=$(t).html(),t=$(t).attr("id");e.val(i),eviivo.pms.pricingRules.editFlyout.disabledFormElements(),eviivo.component.lookup.showSpinner(e.attr("id")),eviivo.pms.pricingRules.editFlyout.getAddRuleHtml("?propertyId=".concat(t),!1)},lookupInitComplete:function(e,t){}})},8786:function(){function t(){$(d.form).submit()}function r(){eviivo.component.flyout.hideFlyout(d.flyout.replace("#",""))}function n(e,t){eviivo.webcore.ajaxHelper.executeAjax({actionId:"add-pricing-rule",url:"".concat(eviivoSuiteApp,"/pricingrules/add").concat(e),method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){c(e.HtmlPayload),t&&eviivo.webcore.parsers.stringToBool(v.isMultiProperty)&&i(),eviivo.component.lookup.hideSpinner(d.propertyLookupInput.replace("#","")),eviivo.webcore.parsers.stringToBool(v.isMultiProperty)&&$(d.propertyLookup).removeClass("hide")},failCallback:function(){r(),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}})}function i(){$(d.flyout).find(d.ruleContainer).find("input").prop("disabled",!0),$(d.flyout).find(d.ruleContainer).find("label").addClass("disabled")}function s(){var e=$(d.saveToBtn);0<e.length&&(e.prop("disabled",!1),eviivo.webcore.tooltip.add(e,""))}function o(){var e=$(d.saveToBtn);0<e.length&&(e.prop("disabled",!0),eviivo.webcore.tooltip.add(e,v.resources.saveToDisabledTooltip))}function a(e){e?$(d.flyout).find(d.flyoutSpinner).removeClass("hide"):$(d.flyout).find(d.flyoutSpinner).addClass("hide")}function l(e){$(d.flyout).find(d.header).html(e)}function c(e){a(!1),$(d.flyout).find(d.ruleContainer).html(e),$(d.flyout).off("click",d.save).on("click",d.save,t),$(d.ruleContainer).on("change","input:visible,select:visible",o)}function u(){a(!0),eviivo.component.flyout.showFlyout(d.flyout)}var d,v;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.editFlyout=(d={flyout:"#view-pricing-rule",body:".s-container-body",ruleContainer:"#manageRuleContainer",header:".s-heading-title",flyoutSpinner:".s-flyout-spinner",save:".s-save",propertyList:"#eviivo-list-property",form:"#frmManageCloseoutRules",saveToBtn:"#save-to",propertyLookup:"#create-flow-property-selector",propertyLookupInput:"#eviivo-lookup-property-create-rule-flow"},v={},{init:function(e){v=eviivo.util.extend(v,e),eviivo.component.lookup.init()},open:function(e){var t,i,o;null==e?(i=v.resources.addHeader,t="",0<$(d.propertyList).length&&(i="".concat(v.resources.addHeader),t="?propertyId=".concat(eviivo.component.listing.getSelectedSingleSelectForList(d.propertyList)),eviivo.webcore.parsers.stringToBool(v.canSaveTo))&&0<(o=$(d.saveToBtn)).length&&o.addClass("hide"),l(i),u(),n(t,!0)):(o=e,l("".concat(v.resources.editHeader," - ").concat(eviivo.pms.pricingRules.listing.getEditedRuleData().PropertyName)),eviivo.webcore.parsers.stringToBool(v.isMultiProperty)&&eviivo.webcore.parsers.stringToBool(v.canSaveTo)&&(0<(i=$(d.saveToBtn)).length?(i.removeClass("hide"),s()):(i=$("".concat(d.flyout)).find("".concat(d.save)),$('<button type="button" class="btn btn-right btn-primary s-saveTo mr8" id="'.concat(d.saveToBtn.replace("#",""),'">').concat(v.resources.saveToBtn,"</button>")).insertAfter(i),$(".s-saveTo").on("click",eviivo.pms.pricingRules.saveTo.performSaveAndOpenSaveTo))),u(),eviivo.webcore.ajaxHelper.executeAjax({actionId:"get-pricing-rule",url:"".concat(eviivoSuiteApp,"/pricingrules/edit"),data:o,method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){c(e.HtmlPayload)},failCallback:function(){r(),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}}))},close:r,flyoutOnShow:function(){},flyoutOnClose:function(){eviivo.pms.pricingRules.createFlyout.close(),eviivo.pms.pricingRules.bulkFlyout.isActive.set=!1,c(""),$(d.propertyLookup).addClass("hide"),eviivo.component.lookup.clearInput(d.propertyLookupInput)},submitForm:t,enableSaveTo:s,getAddRuleHtml:n,disabledFormElements:i})},8267:function(){function e(){var e,t=eviivo.webcore.queryStringHelper.getAllKeys(window.location.href),i=t.propertyid,o=t.ruleid,t=t.typecode;history&&(e=window.location.href.split("?")[0],history.replaceState({},window.title,e)),null!=i&&""!==i&&null!=o&&""!==o&&null!=t&&""!==t&&(e=i,i=t,null!=(o=s("".concat(t=o,"-").concat(i))))&&(C=o,eviivo.pms.pricingRules.editFlyout.open({Id:t,TypeCode:i,PropertyId:e}))}function t(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];R=e,eviivo.component.listing.doesListTableHaveAnySelectedData(f.listTable)&&!e||(e&&eviivo.pms.clone.statusFlyout.resetRefreshOccurrences(),eviivo.component.listing.postInitRefreshDataTableSpecific(f.listTable))}function i(){var e=s($(this).parents("tr").attr("data-id"));null!=e.CloneParentJobId&&eviivo.pms.clone.statusFlyout.open(e.BusinessId,e.CloneParentJobId)}function o(e){e.preventDefault(),eviivo.pms.pricingRules.editFlyout.open()}function r(e){e.preventDefault(),n($(this).parents("tr").attr("data-id"))}function n(e){e=s(e);C=e,eviivo.pms.pricingRules.editFlyout.open({Id:e.Id,TypeCode:e.TypeCode,PropertyId:e.BusinessId})}function s(e){return eviivo.component.listing.getATablesRowDataViaTableId(f.listTable,e)[0]}function a(){u(f.bulkStatusChangeBtn,b.resources.bulkStatusDisabledTooltip)}function l(){u(f.bulkDeleteBtn,b.resources.bulkDeleteDisabledTooltip)}function c(){u(f.bulkUpdateBtn,b.resources.bulkEditDisabledTooltip)}function u(e,t){$(e).hasClass("disabled")?eviivo.webcore.tooltip.add(e,t):eviivo.webcore.tooltip.add(e,"")}function d(){$(f.bulkContainer).find(".md-dd").removeClass("active")}function v(){var e,t;$(this).hasClass("disabled")||null==(e=eviivo.component.listing.getATablesSelectedData(f.listTable)[0])&&null==e.RuleId||(d(),C=e=e,t=[],h().forEach(function(e){t.includes(e.PropertyId)||t.push(e.PropertyId)}),eviivo.pms.pricingRules.bulkFlyout.open({Id:e.Id,TypeCode:e.TypeCode,PropertyId:e.BusinessId,SelectedPropertyIds:t}))}function p(){$(this).hasClass("disabled")||eviivo.component.listing.doesListTableHaveAnySelectedData(f.listTable)&&(d(),eviivo.pms.pricingRules.bulkStatusFlyout.open())}function m(){eviivo.component.listing.doesListTableHaveAnySelectedData(f.listTable)&&(d(),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.warn,style:eviivo.webcore.notifier.styles.withTwoActions,message:b.resources.confirmDeleteMsg,autoHide:!1,buttonTwo:b.resources.yes,buttonOne:b.resources.no}),$(f.deleteConfirmationYes).addClass("btn btn-right"),$(f.deleteConfirmationNo).addClass("btn btn-secondary"),$(".mod-close-notice").off(),$(".mod-close-notice").off("click",function(e){g()}).on("click",function(e){g()}),$(".notifyjs-withTwoActions-base").off("click",f.deleteConfirmationYes,function(e){y()}).on("click",f.deleteConfirmationYes,function(e){y()}),$(".notifyjs-withTwoActions-base").off("click",f.deleteConfirmationNo,function(e){g()}).on("click",f.deleteConfirmationNo,function(e){g()}),$(".notifyjs-hidable").removeClass("notifyjs-hidable"))}function g(){$(".notifyjs-wrapper").remove()}function y(){g(),eviivo.webcore.ajaxHelper.executeAjax({actionId:"bulk-delete-pricing-rule-save",url:"".concat(eviivoSuiteApp,"/api/pricingrules/bulk-delete"),data:{SelectedRules:h()},method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){e?(close(),eviivo.pms.pricingRules.listing.load(!0)):eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})},failCallback:function(){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}})}function h(){var t=[],e=eviivo.component.listing.getATablesSelectedData(f.listTable);return null!=e&&e.forEach(function(e){t.push({RuleId:e.Id,TypeCode:e.TypeCode,PropertyId:e.BusinessId})}),t}var f,b,C,R,w,T;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.listing=(f={listTable:"#eviivo-list-rule",listTableEdit:".s-listing-table-edit",propertyList:"#eviivo-list-property",addBtn:"#btnAddNew",bulkDeleteBtn:"#bulkDelete",bulkUpdateBtn:"#bulkUpdate",bulkStatusChangeBtn:"#bulkStatusChange",deleteConfirmationYes:".btn-two",deleteConfirmationNo:".btn-one",bulkContainer:".s-bulk-update"},C=null,w=!(R=!(b={})),{init:function(e){b=eviivo.util.extend(b,e),eviivo.pms.listingTable.filterActions.init({table:"eviivo-list-rule",callback:function(){t(),$(f.listTable).on("click",f.listTableEdit,r),$(f.listTable).on("click",".update-status .status",i),$(f.addBtn).on("click",o),$(f.bulkDeleteBtn).on("click",m),$(f.bulkStatusChangeBtn).on("click",p),$(f.bulkUpdateBtn).on("click",v)}}),$("body").tip(),c(),a(),l(),eviivo.pms.accessGroup.headerSearch.extendOptions({callBackFunction:function(){t(!0)}})},deleteAjaxDataCallback:function(t){var e={Id:t.Id,TypeCode:t.TypeCode,BusinessId:t.BusinessId};return eviivo.webcore.ajaxHelper.executeAjax({actionId:"RuleDelete-".concat(t.Id),url:"/suite/api/PricingRules/ruledelete",method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.JSON,data:e,callback:function(e){e?(eviivo.component.listing.deleteRowsData(f.listTable,"".concat(t.Id,"-").concat(t.TypeCode)),eviivo.component.listing.filter.updateAllTableFilters(f.listTable)):eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})},failCallback:function(){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}}),!1},load:t,channelsCustomerRender:function(e,t,i){return"sort"==t?null==e||0==e.length&&0==i.Channels?b.resources.pricingRuleListNoChannel:1<i.Channels.length?"".concat(e.length):i.Channels:"display"==t?null==e||0==e.length&&0==i.Channels?b.resources.pricingRuleListNoChannel:1<i.Channels.length?'<span data-tooltip="title" data-tooltip-title="'.concat(e,'" title="" data-tooltip-pos="bottom">').concat(e.length,"</span>"):'<span data-tooltip="title" data-tooltip-title="'.concat(e,'" title="" data-tooltip-pos="bottom">').concat(i.Channels,"</span>"):e},nameCustomerRender:function(e,t,i){return"sort"==t?e.toLowerCase():e},rowSelectionCallback:function(){var t,i,e=eviivo.component.listing.getATablesSelectedData(f.listTable);0==e.length?($(f.bulkDeleteBtn).addClass("disabled"),$(f.bulkStatusChangeBtn).addClass("disabled"),$(f.bulkUpdateBtn).addClass("disabled")):0<e.length&&($(f.bulkDeleteBtn).removeClass("disabled"),$(f.bulkStatusChangeBtn).removeClass("disabled")),1<e.length&&(i=!(t=""),null!=e&&e.forEach(function(e){""==t?t=e.TypeCode:i=i&&t==e.TypeCode}),i?$(f.bulkUpdateBtn).removeClass("disabled"):$(f.bulkUpdateBtn).addClass("disabled")),c(),a(),l()},getEditedRuleData:function(){return C},dataLoadSuccessCallback:function(){e(),$(f.listTable).removeClass("hide"),!R&&w||(eviivo.component.listing.filter.updateAllTableFilters(f.listTable),R=!1),w=w&&!1,""!=T.get&&(setTimeout(n,600,T.get),T.set=""),eviivo.pms.clone.statusFlyout.scheduleMainTableRefreshIfStatusInProgressExists(f.listTable,t)},getSelectedRules:h,rowCreatedCallback:function(e,t,i,o,r){t.Active||$(e).addClass("inactive")},openThisRuleOnListLoadSuccess:T={value:"",get get(){return this.value},set set(e){this.value=e}},getTableData:function(){return eviivo.component.listing.getATablesData(f.listTable)}})},5097:function(){function t(){b=eviivo.component.twoColumnListAssignment.getSelectedSortableItems(y.closeoutRuleAvailableChannels),y.customChannelsCount.html(v.format(b.length))}function i(){y.txtCloseoutRuleStartDate.datepicker("destroy"),y.txtCloseoutRuleEndDate.datepicker("destroy");var e,t=y.selectRoomTypeRadio.is(":checked")?eviivo.eagle.translations.resources.manageClouseoutRule.CloseByRoomType:eviivo.eagle.translations.resources.manageClouseoutRule.CloseEntireProperty,i=p.format(t,y.closeoutRuleStartDate[0].outerHTML,y.closeoutRuleEndDate[0].outerHTML);y.closeBetweenDatesMessage.html(i),y.closeoutRuleStartDate.remove(),y.closeoutRuleEndDate.remove(),y.hdnCloseoutRuleStartDate=d(g.hdnCloseoutRuleStartDate),y.txtCloseoutRuleStartDate=d(g.txtCloseoutRuleStartDate),y.closeoutRuleStartDate=d(g.closeoutRuleStartDate),y.hdnCloseoutRuleEndDate=d(g.hdnCloseoutRuleEndDate),y.txtCloseoutRuleEndDate=d(g.txtCloseoutRuleEndDate),y.closeoutRuleEndDate=d(g.closeoutRuleEndDate),i=m.format(t,y.thresholdLimit[0].outerHTML),y.thresholdLimitMessage.html(i),y.thresholdLimit.remove(),y.thresholdLimit=d(g.thresholdLimit),t=(new Date).evStandardFirstDayCalendarOffset(eviivo.eagle.basePageModelState.userCultureCode),i=eviivo.webcore.datetime.parse.parseDate(y.txtCloseoutRuleStartDate.val()),e=eviivo.webcore.datetime.parse.parseDate(y.txtCloseoutRuleEndDate.val()),y.txtCloseoutRuleStartDate=eviivo.webcore.calendar.init(eviivo.webcore.calendar.CALENDAR_TYPE.initCalendar,{defaultCultureCode:eviivo.eagle.basePageModelState.userCultureCode,calendar:y.txtCloseoutRuleStartDate,dateFormat:eviivo.eagle.dateFormat.getDateFormat("MEDIUM_DATE_FORMAT"),firstDay:t,setDate:i,onSelect:s}),y.txtCloseoutRuleEndDate=eviivo.webcore.calendar.init(eviivo.webcore.calendar.CALENDAR_TYPE.initCalendar,{defaultCultureCode:eviivo.eagle.basePageModelState.userCultureCode,calendar:y.txtCloseoutRuleEndDate,dateFormat:eviivo.eagle.dateFormat.getDateFormat("MEDIUM_DATE_FORMAT"),firstDay:t,setDate:e,onSelect:s}),a()}function o(){y.customChannels.is(":checked")?y.customChannelsWidget.removeClass("hide"):y.customChannelsWidget.addClass("hide")}function r(){i(),y.selectRoomTypeRadio.is(":checked")?(y.sectionRoomType.removeClass("hide"),y.selectRoomTypes.removeAttr("disabled")):(y.sectionRoomType.addClass("hide"),y.selectRoomTypes.attr("disabled","disabled"))}function n(e,t){$('input[name="closeType"]').removeClass("error"),!0!==t&&(y.increasePricePercent.val(""),y.increasePricePercentThresholdLimit.val(""),y.increaseInventoryPricingRuleTypeSelected.val("Percentage"),y.txtCloseoutRuleStartDate.val(""),y.txtCloseoutRuleEndDate.val(""),y.thresholdLimit.val(""),y.hdnCloseoutRuleStartDate.val(""),y.hdnCloseoutRuleEndDate.val(""),y.increaseInventoryPricingRuleSelect.val("increase"),y.decreaseInventoryPricingRuleSelect.val("decrease"),y.decreasePricePercent.val(""),y.decreasePricePercentThresholdLimit.val(""),y.decreaseInventoryPricingRuleTypeSelected.val("Percentage"),y.increasePriceRuleSetup.addClass("hide"),$("#decreasePriceRuleSetup").addClass("hide")),y.closeoutRuleSetup.addClass("hide"),y.closeoutRuleSetupBasedOnDates.addClass("hide"),y.closeoutRuleSetupBasedOnAvailability.addClass("hide"),y.thresholdLimitRadio.is(":checked")?(!0!==t&&(y.increasePricePercent.attr("disabled","disabled"),y.increasePricePercentThresholdLimit.attr("disabled","disabled"),y.increaseInventoryPricingRuleTypeSelected.attr("disabled","disabled"),y.txtCloseoutRuleStartDate.attr("disabled","disabled").removeAttr("readonly"),y.txtCloseoutRuleEndDate.attr("disabled","disabled").removeAttr("readonly"),y.thresholdLimit.attr("disabled","disabled")),"True"==y.isEdit.val()&&y.increasePrice.attr("disabled","disabled"),y.closeoutRuleSetup.removeClass("hide")):y.increasePrice.is(":checked")&&!0!==t&&(c(),y.increasePriceRuleSetup.removeClass("hide")),y.thresholdLimitRadio.is(":checked")&&(y.closeoutRuleSetup.removeClass("hide"),y.closeoutRuleSetupBasedOnAvailability.removeClass("hide"),y.thresholdLimit.removeAttr("disabled"),y.txtCloseoutRuleStartDate.removeAttr("readonly").attr("disabled","disabled"),y.txtCloseoutRuleEndDate.removeAttr("readonly").attr("disabled","disabled")),y.closeBetweenDatesRadio.is(":checked")&&(y.closeoutRuleSetup.removeClass("hide"),y.closeoutRuleSetupBasedOnDates.removeClass("hide"),y.thresholdLimit.attr("disabled","disabled"),y.txtCloseoutRuleStartDate.removeAttr("disabled").attr("readonly","readonly"),y.txtCloseoutRuleEndDate.removeAttr("disabled").attr("readonly","readonly")),eviivo.pms.pricingRules.bulkFlyout.isActive.get||(eviivo.pms.pricingRules.manage.validation.resetValidateCloseInventoryAndIncreasePrice(),eviivo.pms.pricingRules.manage.validation.resetValidateCloseInventoryAndDecreasePrice())}function s(e,t){var i=d("#"+t.id).datepicker("getDate");d("input#"+t.id.replace("txt","hdn")).val(i.evStandardIso8601DateTimeUtcExtended()),0<t.id.indexOf("StartDate")&&(t=y.txtCloseoutRuleEndDate.datepicker("getDate"),y.txtCloseoutRuleEndDate.datepicker("option","minDate",i),i=y.txtCloseoutRuleEndDate.datepicker("getDate"),t)&&(t<i||i<t)&&y.hdnCloseoutRuleEndDate.val(i.evStandardIso8601DateTimeUtcExtended()),(eviivo.pms.pricingRules.bulkFlyout.isActive.get?eviivo.pms.pricingRules.bulkFlyout:eviivo.pms.pricingRules.manage).validation.isFormValid()}function a(){eviivo.pms.pricingRules.manage.validation.init({selectors:g,elements:y,selectedSpecificChannels:function(){return b}})}function l(){$(".s-increase-decrease-section").addClass("hide"),("increase"==$(this).val()?($("#increasePriceRuleSetup").removeClass("hide"),c(),y.decreasePricePercent.val(""),y.decreasePricePercentThresholdLimit.val(""),y.decreaseInventoryPricingRuleTypeSelected):($("#decreasePriceRuleSetup").removeClass("hide"),y.decreasePricePercent.removeAttr("disabled"),y.decreasePricePercentThresholdLimit.removeAttr("disabled"),y.decreaseInventoryPricingRuleTypeSelected.removeAttr("disabled"),y.txtCloseoutRuleStartDate.attr("disabled","disabled").removeAttr("readonly"),y.txtCloseoutRuleEndDate.attr("disabled","disabled").removeAttr("readonly"),y.thresholdLimit.attr("disabled","disabled"),y.decreasePricePercent.trigger("focus"),y.decreaseInventoryPricingRuleSelect.val("decrease"),y.increaseInventoryPricingRuleSelect.val("increase"),y.increasePricePercent.val(""),y.increasePricePercentThresholdLimit.val(""),y.increaseInventoryPricingRuleTypeSelected)).val("Percentage")}function c(){y.increasePricePercent.removeAttr("disabled"),y.increasePricePercentThresholdLimit.removeAttr("disabled"),y.increaseInventoryPricingRuleTypeSelected.removeAttr("disabled"),y.txtCloseoutRuleStartDate.attr("disabled","disabled").removeAttr("readonly"),y.txtCloseoutRuleEndDate.attr("disabled","disabled").removeAttr("readonly"),y.thresholdLimit.attr("disabled","disabled"),y.increasePricePercent.trigger("focus"),y.increaseInventoryPricingRuleSelect.val("increase"),y.decreaseInventoryPricingRuleSelect.val("decrease")}function u(e){0!=e.DataPayload?(""==$("#Id").val()&&(eviivo.pms.pricingRules.editFlyout.close(),eviivo.pms.pricingRules.listing.openThisRuleOnListLoadSuccess.set="".concat(e.DataPayload,"-").concat(e.HtmlPayload)),eviivo.pms.pricingRules.saveTo.performingSaveTo.get?eviivo.pms.pricingRules.saveTo.open():(eviivo.pms.pricingRules.listing.load(!0),eviivo.pms.pricingRules.editFlyout.enableSaveTo(),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.success,message:eviivo.eagle.translations.resources.notify.saveSuccessText}))):eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}var d,v,p,m,g,y,h,f,b;window.eviivo=window.eviivo||{},window.eviivo.eagle=window.eviivo.eagle||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.manage=(g={form:"#frmManageCloseoutRules",selectRoomTypeRadio:"#isForRoomType",selectEntireProperty:"#isEntireProperty",selectRoomTypes:"#selectRoomTypes",sectionRoomType:"#section-RoomType",closeInventory:"#closeInventory",increasePrice:"#increasePrice",closeoutRuleSetup:"#closeoutRuleSetup",increasePriceRuleSetup:"#increasePriceRuleSetup",closeBetweenDatesRadio:"#closeBetweenDatesRadio",closeBetweenDatesMessage:"#closeBetweenDatesMessage",hdnCloseoutRuleStartDate:"#hdnCloseoutRuleStartDate",txtCloseoutRuleStartDate:"#txtCloseoutRuleStartDate",closeoutRuleStartDate:"#closeoutRuleStartDate",hdnCloseoutRuleEndDate:"#hdnCloseoutRuleEndDate",txtCloseoutRuleEndDate:"#txtCloseoutRuleEndDate",closeoutRuleEndDate:"#closeoutRuleEndDate",thresholdLimitMessage:"#thresholdLimitMessage",thresholdLimit:"#thresholdLimit",thresholdLimitRadio:"#thresholdLimitRadio",customChannels:"#customChannels",allChannels:"#allChannels",commissionChannels:"#commissionChannels",customChannelsCount:"#customChannelsCount",customChannelsWidget:"#customChannelsWidget",closeoutRuleAvailableChannels:"#closeoutRule-availableChannels",lblChannelType:"#lblChannelType",widgetSortableRightColumn:"#sortableRightColumn",percentIncreaseMessage:"#percentIncreaseMessage",increaseInventoryPricingRuleSelect:"#increaseInventoryPricingRuleSelect",increasePricePercent:"#increasePricePercent",increasePricePercentThresholdLimit:"#increasePricePercentThresholdLimit",increaseInventoryPricingRuleTypeSelected:"#increaseInventoryPricingRuleTypeSelected",decreasePrice:"#decreasePrice",decreaseInventoryPricingRuleSelect:"#decreaseInventoryPricingRuleSelect",decreasePriceRuleSetup:"#decreasePriceRuleSetup",percentDecreaseMessage:"#percentDecreaseMessage",decreasePricePercent:"#decreasePricePercent",decreasePricePercentThresholdLimit:"#decreasePricePercentThresholdLimit",decreaseInventoryPricingRuleTypeSelected:"#decreaseInventoryPricingRuleTypeSelected",closeoutRuleSetupBasedOnDates:"#closeoutRuleSetupBasedOnDates",closeoutRuleSetupBasedOnAvailability:"#closeoutRuleSetupBasedOnAvailability",isEdit:"#IsEdit"},y={},h="eviivo.pms.pricingRule.manage",f={},b=[],{init:function(e){if("function"!=typeof jQuery)throw h+": module depends on jQuery";(d=jQuery).extend({},e),f={click:eviivo.util.namespacedEvent("click",h),change:eviivo.util.namespacedEvent("change",h)},y.form=d(g.form),y.selectRoomTypeRadio=d(g.selectRoomTypeRadio),y.selectEntireProperty=d(g.selectEntireProperty),y.selectRoomTypes=d(g.selectRoomTypes),y.sectionRoomType=d(g.sectionRoomType),y.closeInventory=d(g.closeInventory),y.closeoutRuleSetup=d(g.closeoutRuleSetup),y.closeBetweenDatesRadio=d(g.closeBetweenDatesRadio),y.closeBetweenDatesMessage=d(g.closeBetweenDatesMessage),y.hdnCloseoutRuleStartDate=d(g.hdnCloseoutRuleStartDate),y.txtCloseoutRuleStartDate=d(g.txtCloseoutRuleStartDate),y.closeoutRuleStartDate=d(g.closeoutRuleStartDate),y.hdnCloseoutRuleEndDate=d(g.hdnCloseoutRuleEndDate),y.txtCloseoutRuleEndDate=d(g.txtCloseoutRuleEndDate),y.closeoutRuleEndDate=d(g.closeoutRuleEndDate),y.thresholdLimitRadio=d(g.thresholdLimitRadio),y.thresholdLimitMessage=d(g.thresholdLimitMessage),y.thresholdLimit=d(g.thresholdLimit),y.allChannels=d(g.allChannels),y.commissionChannels=d(g.commissionChannels),y.customChannels=d(g.customChannels),y.customChannelsWidget=d(g.customChannelsWidget),y.customChannelsCount=d(g.customChannelsCount),y.closeoutRuleAvailableChannels=d(g.closeoutRuleAvailableChannels),y.lblChannelType=d(g.lblChannelType),y.widgetSortableRightColumn=d(g.widgetSortableRightColumn).parent(),y.increasePrice=d(g.increasePrice),y.increaseInventoryPricingRuleSelect=d(g.increaseInventoryPricingRuleSelect),y.increasePriceRuleSetup=d(g.increasePriceRuleSetup),y.percentIncreaseMessage=d(g.percentIncreaseMessage),y.increasePricePercent=d(g.increasePricePercent),y.increasePricePercentThresholdLimit=d(g.increasePricePercentThresholdLimit),y.increaseInventoryPricingRuleTypeSelected=d(g.increaseInventoryPricingRuleTypeSelected),y.decreasePrice=d(g.decreasePrice),y.decreaseInventoryPricingRuleSelect=d(g.decreaseInventoryPricingRuleSelect),y.decreasePriceRuleSetup=d(g.decreasePriceRuleSetup),y.percentDecreaseMessage=d(g.percentDecreaseMessage),y.decreasePricePercent=d(g.decreasePricePercent),y.decreasePricePercentThresholdLimit=d(g.decreasePricePercentThresholdLimit),y.decreaseInventoryPricingRuleTypeSelected=d(g.decreaseInventoryPricingRuleTypeSelected),y.closeoutRuleSetupBasedOnAvailability=d(g.closeoutRuleSetupBasedOnAvailability),y.closeoutRuleSetupBasedOnDates=d(g.closeoutRuleSetupBasedOnDates),y.isEdit=d(g.isEdit),v=y.customChannelsCount.html(),p=y.closeBetweenDatesMessage.html(),m=y.thresholdLimitMessage.html(),i(),e=(e=y.percentIncreaseMessage.html()).format(y.increaseInventoryPricingRuleSelect[0].outerHTML,y.increasePricePercent[0].outerHTML,y.increaseInventoryPricingRuleTypeSelected[0].outerHTML,y.increasePricePercentThresholdLimit[0].outerHTML),y.increaseInventoryPricingRuleSelect.remove(),y.percentIncreaseMessage.html(e),y.increasePricePercent.remove(),y.increasePricePercentThresholdLimit.remove(),y.increaseInventoryPricingRuleTypeSelected.remove(),y.increaseInventoryPricingRuleSelect=d(g.increaseInventoryPricingRuleSelect),y.increasePricePercent=d(g.increasePricePercent),y.increasePricePercentThresholdLimit=d(g.increasePricePercentThresholdLimit),y.increaseInventoryPricingRuleTypeSelected=d(g.increaseInventoryPricingRuleTypeSelected),e=(e=y.percentDecreaseMessage.html()).format(y.decreaseInventoryPricingRuleSelect[0].outerHTML,y.decreasePricePercent[0].outerHTML,y.decreaseInventoryPricingRuleTypeSelected[0].outerHTML,y.decreasePricePercentThresholdLimit[0].outerHTML),y.decreaseInventoryPricingRuleSelect.remove(),y.percentDecreaseMessage.html(e),y.decreasePricePercent.remove(),y.decreasePricePercentThresholdLimit.remove(),y.decreaseInventoryPricingRuleTypeSelected.remove(),y.decreaseInventoryPricingRuleSelect=d(g.decreaseInventoryPricingRuleSelect),y.decreasePricePercent=d(g.decreasePricePercent),y.decreasePricePercentThresholdLimit=d(g.decreasePricePercentThresholdLimit),y.decreaseInventoryPricingRuleTypeSelected=d(g.decreaseInventoryPricingRuleTypeSelected),n(0,!0),o(),y.selectRoomTypeRadio.on(f.click,r),y.selectEntireProperty.on(f.click,r),y.thresholdLimitRadio.on(f.click,n),y.closeBetweenDatesRadio.on(f.click,n),y.increasePrice.on(f.click,n),y.customChannels.on(f.click,o),y.commissionChannels.on(f.click,o),y.allChannels.on(f.click,o),$(".s-increase-decrease-select").on("change",l),y.form.on("input keyup change","select:visible.error, input:visible.error, :radio[name=ChannelType]",function(){(eviivo.pms.pricingRules.bulkFlyout.isActive.get?eviivo.pms.pricingRules.bulkFlyout:eviivo.pms.pricingRules.manage).validation.isFormValid()}),eviivo.pms.pricingRules.bulkFlyout.isActive.get?eviivo.pms.pricingRules.bulkFlyout.validation.init({selectors:g,elements:y,selectedSpecificChannels:function(){return b}}):(a(),y.form.attr("action","".concat(eviivoSuiteApp,"/api/pricingrules/").concat(eviivo.webcore.parsers.stringToBool(y.isEdit.val())?"edit":"add")),eviivo.webcore.forms.load({placeholder:y.form.parent(),id:y.form.attr("id"),spinnerSettings:{container:g.form},disableErrorNotification:!0,notificationSettings:{submitSuccess:{enabled:!1}},shouldAutoValidate:!1,validateOptions:{ignore:"",showErrors:function(e,t){this.defaultShowErrors()},errorPlacement:function(){return!0},errorLabelContainer:"#closeout-validation-summary",errorContainer:"#closeout-validation-summary ul",wrapper:"li",onfocusout:!1,errorClass:"error"},actions:{onSubmitSuccess:u,onSubmitFail:function(e){null!=e&&null!=e.Errors&&0<e.Errors.length&&eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:e.Errors[0],autoHide:!1})},extraFormData:function(){return{StartDate:y.closeBetweenDatesRadio.is(":checked")?y.txtCloseoutRuleStartDate.datepicker("getDate").evStandardIso8601DateExtended():null,EndDate:y.closeBetweenDatesRadio.is(":checked")?y.txtCloseoutRuleEndDate.datepicker("getDate").evStandardIso8601DateExtended():null,ChannelIds:b,IncreasePricePercent:eviivo.webcore.decimals.fixDecimalSymbolSave(y.increasePricePercent.val(),","),DecreasePricePercent:eviivo.webcore.decimals.fixDecimalSymbolSave(y.decreasePricePercent.val(),",")}},onValidate:eviivo.pms.pricingRules.manage.validation.isFormValid}})),eviivo.component.twoColumnListAssignment.init({container:y.closeoutRuleAvailableChannels,callback:function(){t(),eviivo.pms.pricingRules.manage.validation.validateCustomChannels()},showCountOnZero:!1,resources:{ChannelLeftColumn:eviivo.eagle.translations.resources.manageClouseoutRule.RuleDoesNotApplyToChannels,ChannelRightColumn:eviivo.eagle.translations.resources.manageClouseoutRule.RuleDoesApplyToChannels}}),t()}})},5934:function(){function R(e,t,i){e=e.replace("#","");var o=I.validationSummary.find("#error-"+e);0===o.length?!0!==t?(o=r('<li id="error-'+e+'"><label class="error" for="'+e+'" style="display: inline;"></label></li>')).appendTo(I.validationSummary):o=null:t&&(o.remove(),o=null),null!=o&&(o=o.find("label")).html(i),0<I.validationSummary.find("li").length?I.validationSummary.parent().show():I.validationSummary.parent().hide()}function w(){var e=!0;return I.thresholdLimitMessage.parent().removeClass("error"),I.closeBetweenDatesMessage.parent().removeClass("error"),I.closeInventory.is(":checked")&&1!=(e=I.thresholdLimitRadio.is(":checked")||I.closeBetweenDatesRadio.is(":checked"))&&(I.thresholdLimitMessage.parent().addClass("error"),I.closeBetweenDatesMessage.parent().addClass("error")),R(S.closeInventory,e,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.CloseInventory),e}function T(){var e=w(),t=!0;return I.txtCloseoutRuleStartDate.removeClass("error"),I.txtCloseoutRuleEndDate.removeClass("error"),!0===e&&I.closeBetweenDatesRadio.is(":checked")&&1!=(t=""!==I.hdnCloseoutRuleStartDate.val()&&""!==I.hdnCloseoutRuleEndDate.val())&&(I.txtCloseoutRuleStartDate.addClass("error"),I.txtCloseoutRuleEndDate.addClass("error")),R(S.txtCloseoutRuleStartDate,t,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.DateRange),t}function P(){var e=!0;return I.lblChannelType.removeClass("error"),I.widgetSortableRightColumn.removeClass("error"),I.customChannels.is(":checked")&&1!=(e=null!=t.selectedSpecificChannels()&&0<t.selectedSpecificChannels().length)&&(I.lblChannelType.addClass("error"),I.widgetSortableRightColumn.addClass("error")),R(S.lblChannelType,e,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.CustomChannels),e}var r,t,S,I,D,A;window.eviivo=window.eviivo||{},window.eviivo.eagle=window.eviivo.eagle||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.manage=window.eviivo.pms.pricingRules.manage||{},window.eviivo.pms.pricingRules.manage.validation=(S={closeoutRuleName:"#closeoutRuleName",validationSummary:"#closeout-validation-summary ul"},I={},D=/^((?!0\.\s,\t\n\r)[1-9])*$|^[1-9]+[0-9]*$/i,A=/^[\w0-9\-_\+\.,:;%\?\!|\(\) =&]{3,}/i,{init:function(e){if("function"!=typeof jQuery)throw"eviivo.eagle.closeoutRule.manage.validation: module depends on jQuery";t=(r=jQuery).extend({},e),I=r.extend({},I,e.elements),S=r.extend({},S,e.selectors),I.closeoutRuleName=r(S.closeoutRuleName),I.validationSummary=r(S.validationSummary),eviivo.webcore.decimals.restrictFieldsForNumbers(I.thresholdLimit),eviivo.webcore.decimals.restrictFieldsForNumbers(I.increasePricePercentThresholdLimit),eviivo.webcore.decimals.restrictFieldsForNumbers(I.decreasePricePercentThresholdLimit),eviivo.webcore.decimals.restrictFieldsForDecimals(I.decreasePricePercent),eviivo.webcore.decimals.restrictFieldsForDecimals(I.increasePricePercent)},isFormValid:function(){I.closeoutRuleName.removeClass("error"),1!=(d=null!=I.closeoutRuleName.val()&&""!==I.closeoutRuleName.val().trim()&&A.test(I.closeoutRuleName.val()))&&I.closeoutRuleName.addClass("error"),R(S.closeoutRuleName,d,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.Name),(v=0<$('input[name="closeType"]:checked').length)?$('input[name="closeType"]').removeClass("error"):$('input[name="closeType"]').addClass("error"),p=!0,I.selectRoomTypes.removeClass("error"),I.selectRoomTypeRadio.is(":checked")&&1!=(p=null!=I.selectRoomTypes.val()&&""!==I.selectRoomTypes.val())&&I.selectRoomTypes.addClass("error"),R(S.selectRoomTypes,p,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomType);var e,t,i,o,r,n,s,a,l,c,u,d,v,p,m,g=w(),y=(y=w(),h=!0,I.thresholdLimit.removeClass("error"),!0===y&&I.thresholdLimitRadio.is(":checked")&&1!=(h=""!==I.thresholdLimit.val()&&D.test(I.thresholdLimit.val()))&&I.thresholdLimit.addClass("error"),R(S.thresholdLimit,h,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),h),h=T(),f=P(),b=(m=!0,I.increasePricePercentThresholdLimit.removeClass("error"),I.decreasePricePercentThresholdLimit.removeClass("error"),I.increasePrice.is(":checked")&&("increase"==$(".s-increase-decrease-select:visible").val()&&1!=(m=""!==I.increasePricePercentThresholdLimit.val()&&D.test(I.increasePricePercentThresholdLimit.val()))&&I.increasePricePercentThresholdLimit.addClass("error"),"decrease"==$(".s-increase-decrease-select:visible").val())&&1!=(m=""!==I.decreasePricePercentThresholdLimit.val()&&D.test(I.decreasePricePercentThresholdLimit.val()))&&I.decreasePricePercentThresholdLimit.addClass("error"),R(S.increasePricePercentThresholdLimit,m,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),C=!0,u="",b=I.increaseInventoryPricingRuleTypeSelected.val(),e=I.increasePricePercent.val().replace(",","."),I.increaseInventoryPricingRuleTypeSelected.removeClass("error"),I.increasePricePercent.removeClass("error"),"increase"==$(".s-increase-decrease-select:visible").val()&&(1!=(C=null!=b&&""!==b)&&(I.increaseInventoryPricingRuleTypeSelected.addClass("error"),u=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PricingRuleType),""==e&&(I.increasePricePercent.addClass("error"),u=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceIncreasePercentage,C=!1),"percentage"==b.toLowerCase())&&100<Globalize.parseNumber(e)&&(I.increaseInventoryPricingRuleTypeSelected.addClass("error"),I.increasePricePercent.addClass("error"),u=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceIncreasePercentage,C=!1),R(S.increaseInventoryPricingRuleTypeSelected,C,u),C),C=(e=!0,u="",C=I.decreaseInventoryPricingRuleTypeSelected.val(),c=I.decreasePricePercent.val().replace(",","."),I.decreaseInventoryPricingRuleTypeSelected.removeClass("error"),I.decreasePricePercent.removeClass("error"),"decrease"==$(".s-increase-decrease-select:visible").val()&&(1!=(e=null!=C&&""!==C)&&(I.decreaseInventoryPricingRuleTypeSelected.addClass("error"),u=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PricingRuleType),""==c&&(I.decreasePricePercent.addClass("error"),u=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceDecreasePercentage,e=!1),"percentage"==C.toLowerCase())&&100<Globalize.parseNumber(c)&&(I.decreaseInventoryPricingRuleTypeSelected.addClass("error"),I.decreasePricePercent.addClass("error"),u=eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceDecreasePercentage,e=!1),R(S.decreaseInventoryPricingRuleTypeSelected,e,u),e);return c=!0,0<(u=$(".s-increase-decrease-select:visible")).length&&(a=[].concat.apply([],eviivo.pms.pricingRules.listing.getTableData()),t=$("#Id").val(),i=$("#BusinessId").val(),""==(o=$("#selectRoomTypes").val())&&(o=null),r="decrease"==(u=u.val())?null==o?"PDBI":"PDRI":null==o?"PBI":"PRI",n=("decrease"==u?$("#decreasePricePercentThresholdLimit"):$("#increasePricePercentThresholdLimit")).val(),s="","CustomChannels"==$('input[name="ChannelType"]:checked').val()&&(s=$("#customChannelsWidget .mod-sortable_right-column").find("li").text().split("\n").filter(function(e){return""!==e.trim()})),""!=n)&&(a=""!=t?a.filter(function(e){return e.BusinessId==i&&e.RoomTypeId==o&&e.TypeCode==r&&e.InventoryThreshold==n&&e.Id!=t}):a.filter(function(e){return e.BusinessId==i&&e.RoomTypeId==o&&e.TypeCode==r&&e.InventoryThreshold==n}),(l=0)<a.length&&0<s.length&&$.each(a,function(t){if($.each(s,function(e){if(0<(l+=0<=jQuery.inArray(s[e].trim(),a[t].ChannelsFilter)))return!1}),0<l)return!1}),c=0==a.length||!(0<a.length&&""==s||0<a.length&&0<s.length&&0<l)),R(S.decreaseInventoryPricingRuleTypeSelected,c,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.priceIncreaseDecreaseExists),d&&v&&p&&g&&y&&h&&f&&m&&b&&C&&c},validateCustomChannels:P,validateCloseRuleDateRange:T,resetValidateCloseInventoryAndIncreasePrice:function(){I.thresholdLimitMessage.parent().removeClass("error"),I.closeBetweenDatesMessage.parent().removeClass("error"),I.increasePricePercentThresholdLimit.removeClass("error"),I.increasePricePercent.removeClass("error"),I.thresholdLimit.removeClass("error"),I.txtCloseoutRuleStartDate.removeClass("error"),I.txtCloseoutRuleEndDate.removeClass("error"),R(S.closeInventory,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.CloseInventory),R(S.increasePricePercentThresholdLimit,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),R(S.increasePricePercent,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceIncreasePercentage),R(S.thresholdLimit,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),R(S.txtCloseoutRuleStartDate,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.DateRange)},resetValidateCloseInventoryAndDecreasePrice:function(){I.thresholdLimitMessage.parent().removeClass("error"),I.closeBetweenDatesMessage.parent().removeClass("error"),I.decreasePricePercentThresholdLimit.removeClass("error"),I.decreasePricePercent.removeClass("error"),I.thresholdLimit.removeClass("error"),I.txtCloseoutRuleStartDate.removeClass("error"),I.txtCloseoutRuleEndDate.removeClass("error"),R(S.closeInventory,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.CloseInventory),R(S.decreasePricePercentThresholdLimit,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),R(S.decreasePricePercent,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.PriceDecreasePercentage),R(S.thresholdLimit,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.RoomsLeft),R(S.txtCloseoutRuleStartDate,!0,eviivo.eagle.translations.resources.manageClouseoutRule.validationMessages.DateRange)}})},4972:function(){function t(){eviivo.component.listing.validateSingleSelectForList(r.propertyList)&&(!function(e,t,i){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;null==o&&(o=eviivo.webcore.notifier.positions.topLeft);eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.info,style:eviivo.webcore.notifier.styles.withTwoActions,message:t,autoHide:!1,buttonTwo:n.resources.proceed,buttonOne:n.resources.cancel,selector:e,position:o}),$(r.notifierBtnOne).addClass("btn btn-secondary"),$(r.notifierBtnTwo).addClass("btn btn-right ".concat(i))}($(this),n.resources.confirmText,"btn-confirm",eviivo.webcore.notifier.positions.topRight),$("body").on("click",r.confirmBtn,e))}function e(){var e=eviivo.pms.pricingRules.listing.getEditedRuleData();eviivo.webcore.ajaxHelper.executeAjax({actionId:"save-to",url:"".concat(eviivoSuiteApp,"/api/pricingrules/save-to"),data:{SourcePropertyId:e.BusinessId,SourceRuleId:e.Id,SourceRuleType:e.TypeCode,DestinationPropertyIds:eviivo.component.listing.getSelectedMultiSelectForList(r.propertyList)},method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){e?(i(),eviivo.pms.pricingRules.editFlyout.close(),eviivo.pms.pricingRules.listing.load(!0),eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.success,message:eviivo.eagle.translations.resources.notify.copyStartedText})):eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})},failCallback:function(){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}})}function i(){eviivo.component.flyout.hideFlyout(r.flyout.replace("#",""))}function o(){eviivo.component.listing.postInitRefreshDataTableSpecific(r.propertyList),eviivo.component.flyout.showFlyout(r.flyout)}var r,n,s;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.pricingRules=window.eviivo.pms.pricingRules||{},window.eviivo.pms.pricingRules.saveTo=(r={flyout:"#pricing-rule-save-to-property-selection",save:".s-save",propertyList:"#eviivo-list-property_save_to",confirmBtn:".btn-confirm",notifierBtnOne:".btn-one",notifierBtnTwo:".btn-two"},{init:function(e){n=eviivo.util.extend(n,e),$(r.flyout).on("click",r.save,t)},open:o,close:i,flyoutOnShow:function(){},flyoutOnClose:function(){s.set=!1},ajaxDataCallback:function(){return{SourcePropertyId:eviivo.pms.pricingRules.listing.getEditedRuleData().BusinessId}},performSaveAndOpenSaveTo:function(){s.set=!0,o()},performingSaveTo:s={value:!(n={}),get get(){return this.value},set set(e){this.value=e}}})}},o={};function r(e){var t=o[e];return void 0!==t||(t=o[e]={exports:{}},i[e](t,t.exports,r)),t.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";r(8267),r(8786),r(4369),r(5097),r(5934),r(7887),r(1452),r(4972),r(8381),r(5758),r(2836),r(2679),r(79)}();
//# sourceMappingURL=pricingRules.min.js.map