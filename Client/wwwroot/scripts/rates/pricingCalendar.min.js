var t={3640:function(){function a(){eviivo.component.popup.showPopup("displayCalendarSyncMaster")}function t(){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.warn,style:eviivo.webcore.notifier.styles.withTwoActions,message:"<strong>"+i.resources.ManageIndependently.PopupTitle+"</strong><br/><div>"+i.resources.ManageIndependently.PopupText+"</div>",autoHide:!1,buttonTwo:i.resources.ManageIndependently.PopupYes,buttonOne:i.resources.ManageIndependently.PopupCancel}),$(".btn-one").addClass("btn btn-secondary"),$(".btn-two").addClass("btn").addClass("btn-right"),$(".notifyjs-withTwoActions-base").on("click",".btn-one",function(){$(this).trigger("notify-hide")}),$(".notifyjs-withTwoActions-base").on("click",".btn-two",function(){eviivo.webcore.ajaxHelper.executeAjax({actionId:"ClonePricingCalendarDetach",url:eviivoSuiteApp+"/api/clone/CalendarDetach",method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){eviivo.webcore.parsers.stringToBool(e)?window.location.href=window.location.pathname+"?independent=true":eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:eviivo.eagle.translations.resources.notify.genericErrorMessage})}}),$(this).trigger("notify-hide")}),document.addEventListener("keydown",function(e){"Escape"===e.key&&$(".notifyjs-withTwoActions-base").trigger("notify-hide")})}var r,i,n;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.clone=window.eviivo.pms.clone||{},window.eviivo.pms.clone.calendar=window.eviivo.pms.clone.calendar||{},window.eviivo.pms.clone.calendar=(n=!(i={}),{calendarSyncRenderTarget:function(e,a,t){return'<div class="cp-slide-toggle" data-extractvalue="eviivo.pms.clone.calendar.customRenderCalendarValueSave" ><input type="checkbox" id="cbselect_centralised-'+t.Id+'"><label for="cbselect_centralised-'+t.Id+'"><span class="slide"><span class="toggle"></span></span></label></div>'},calendarSyncRenderSummary:function(e,a,t){return eviivo.webcore.parsers.stringToBool(e)?'<svg class="icon-bg icon-bg-check"><use xlink:href="#icon-bg-check"></use></svg>':""},customRenderCalendarValueSave:function(e){return document.getElementById("cbselect_centralised-"+e).checked},customRenderActionCalendarPopupMasterSyncView:function(e,a,t){return'<a id="'+e+'" href="" class="md-table_action md-table_action-item s-select-business"><svg class="icon-bg icon-bg-eye-outline" > <use xlink: href="#icon-bg-eye-outline"></use></svg></a>'},syncedToMasterOnShow:function(){$.fn.dataTable.isDataTable("#eviivo-list-calendarsyncmaster")?$("#eviivo-list-calendarsyncmaster").DataTable().ajax.reload():"function"==typeof postInitListingTable&&postInitListingTable()},syncedToMasterPostDataTable:function(){for(var e,a=document.getElementById("eviivo-list-calendarsyncmaster"),t=0;e=a.rows[t];t++)$(e).data("bid",$(e).data("id"));eviivo.pms.switchBusiness.init({manageLinkSelector:"a.s-select-business"}),$("#property-search-input").on("keyup",function(){$("#eviivo-list-calendarsyncmaster").DataTable().search(this.value).draw()})},checkIfCalendarIsSyncedMaster:function(){eviivo.webcore.ajaxHelper.executeAjax({actionId:"ClonePricingCalendarSynedMasterCheck",url:eviivoSuiteApp+"/api/clone/CalendarSyncMasterlist",method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){""!=e&&(r=e,"function"==typeof postPopupInit&&postPopupInit(),$("#Calendar_Sync_Master_Warning").removeClass("hide"),(e=$("#Calendar_Sync_Master_Warning").find("a"))[0].innerText=e[0].innerText.replace("(x)",r.length),eviivo.component.handlers.assign(".s-master-sync-calendar",a,"click"))}})},checkIfCalendarIsSyncedCloned:function(){eviivo.webcore.ajaxHelper.executeAjax({actionId:"ClonePricingCalendarSynedCheck",url:eviivoSuiteApp+"/api/clone/CalendarSynced",method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){var a;""!=e&&(e=e,(a=$("#pnlPricingPeriods .mod-collapsable").filter("[type=2],[type=3]")).find(".pricing-icon-edit").addClass("hide"),a.find(".cp-icon-edit").addClass("hide"),a.find(".cp-icon-delete").addClass("hide"),a.find("button").addClass("hide"),$("#Calendar_Synced_Warning").removeClass("hide"),(a=$("#Calendar_Synced_Warning").find("div"))[0].innerText=a[0].innerText.replace("{propertyName}",e),$("#Manage_Independently_Button").removeClass("hide"),$("#Manage_Independently_Button").on("click",t),n=!0)}})},removeSeasonEventsIfSyncCloned:function(){n&&($(".s-addCalendarBtnType2").remove(),$(".s-addCalendarBtnType3").remove(),$(".s-addCalendarBtnType1").trigger("click"),$(".s-addCalendarBtnType1").hide(),$(".eviivo-period-types").html("<input type='text' value='"+$(".s-addCalendarBtnType1").html()+"' disabled='disabled'/>"))},manageIndependentSuccess:function(){var e=eviivo.webcore.queryStringHelper.getAllKeys(window.location.href).independent;null!=e&&eviivo.webcore.parsers.stringToBool(e)&&(eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.success,message:i.resources.ManageIndependently.SuccessConfirmation}),history)&&(e=window.location.href.split("?")[0],history.replaceState({},window.title,e))},initPricingCalendar:function(e){i=eviivo.util.extend(i,e)},refresh:function(){location.reload()}})},3348:function(){function R(){var t,r=this;r.periodTypes=ko.observableArray([]),r.selectedPeriodType=null,r.selectedPeriodName=null,r.selectedPeriodId=null,r.selectedDateRangeId=null,r.addPeriodType=function(e){r.periodTypes.push(new a(e))},r.addPeriod=function(e){var a=r.periodTypes();for(t=0;t<a.length;t++)a[t].Type===r.selectedPeriodType&&a[t].addPeriod(e)}}function L(){var a=this;a.warnings=ko.observableArray(),a.errors=ko.observableArray(),a.addWarning=function(e){a.warnings.push(e)},a.removeWarning=function(e){a.warnings.remove(e)},a.addError=function(e){a.errors.push(e)}}function a(e){var r,i=this;i.Type=e.Type,i.Name=e.Name,i.AllowCreate=e.AllowCreate,i.AllowEdit=e.AllowEdit,i.AllowDelete=e.AllowDelete,i.IsVisible=e.IsVisible,i.Periods=ko.observableArray([]),i.addPeriod=function(e){var a=null,t=i.Periods();for(r=0;r<t.length;r++)t[r].Id===e.Id&&(a=t[r]);null===a?i.Periods.push(new n(e,i)):a.addDateRange(e.PeriodDateRanges)},ko.utils.arrayForEach(e.Periods,function(e){i.Periods.push(new n(e,i))})}function n(e,a){var n=this;n.Parent=a,n.Id=e.Id,n.Name=e.Name,n.IsVisible=e.IsVisible,n.ColorClassName=ko.computed(function(){return"btn btn-small "+g(e.PeriodColor.Name)},n),n.DateRanges=ko.observableArray([]),n.addDateRange=function(e){for(var a=n.DateRanges(),t=null,r=0;r<e.length;r++)for(var i=0;i<a.length;i++)a[i].Id!==e[r].Id&&(t=e[r]);null!==t&&n.DateRanges.push(new o(t,n))},ko.utils.arrayForEach(e.PeriodDateRanges,function(e){n.DateRanges.push(new o(e,n))}),n.addDates=Y,n.editPeriodName=J}function o(e,a){var t=this;t.Parent=a,t.Id=e.Id,t.StartDate=e.StartDate,t.EndDate=e.EndDate,t.AllowEdit=a.Parent.AllowEdit,t.AllowDelete=a.Parent.AllowDelete,t.Date=eviivo.webcore.datetime.parse.parseDate(e.StartDate).evDisplayLongDate(eviivo.eagle.basePageModelState.userCultureCode),t.Date+=" - ",t.Date+=eviivo.webcore.datetime.parse.parseDate(e.EndDate).evDisplayLongDate(eviivo.eagle.basePageModelState.userCultureCode),t.edit=B,t.eliminate=F}function B(e){f=eviivo.webcore.datetime.parse.parseDate(e.StartDate),m=eviivo.webcore.datetime.parse.parseDate(e.EndDate),h.selectedPeriodType=e.Parent.Parent.Type,h.selectedPeriodName=$.parseHTML(e.Parent.Name)[0].textContent,h.selectedPeriodId=e.Parent.Id,h.selectedDateRangeId=e.Id,d(E.ModifyDateRange)}function F(e){h.selectedPeriodType=e.Parent.Parent.Type,h.selectedPeriodName=$.parseHTML(e.Parent.Name)[0].textContent,h.selectedPeriodId=e.Parent.Id,h.selectedDateRangeId=e.Id,j.removeClass("active").addClass("hide"),eviivo.eagle.popup.show({popupBox:C,closeButton:C.find(".s-close"),onShow:function(){var e=function(e){switch(e){case A.Season:return" "+v.resources.DeleteMessageSeasonAreYouSure;case A.Closure:return" "+v.resources.DeleteMessageClosureAreYouSure;case A.Event:return" "+v.resources.DeleteMessageEventAreYouSure;default:return" "}}(h.selectedPeriodType),a=function(e){switch(e){case A.Season:return" "+v.resources.DeleteMessageSeasonRateSetUp;case A.Event:return" "+v.resources.DeleteMessageEventRateSetUp;default:return" "}}(h.selectedPeriodType);h.selectedPeriodType!==A.Closure&&(e=e+"<br/>"+a),C.find("span.delete-message").html(e)},onClose:i})}function Y(e,a){h.selectedPeriodType=e.Type,h.selectedPeriodName=$.parseHTML(a.Name)[0].textContent,h.selectedPeriodId=a.Id,d(E.AddDateRange)}function J(e,a){h.selectedPeriodType=e.Type,h.selectedPeriodName=$.parseHTML(a.Name)[0].textContent,h.selectedPeriodId=a.Id,d(E.ModifyPeriod)}function r(){null===f?$(w).attr("title",v.resources.SelectStartDateTooltip):null===m?$(w).attr("title",v.resources.SelectEndDateTooltip):$(w).removeAttr("title")}function U(){x={},y.find(".ui-datepicker-calendar td[class!='ui-datepicker-other-month']").each(function(e,a){var t=parseInt($(a).data("year")),r=parseInt($(a).data("month")),i=parseInt($(a).find("a").html()),t=new Date(t,r,i).evStandardIso8601DateExtended();x[t]=$(a)})}function W(){null===re?$(".pricing-calendar .btn-year-prev").attr("disabled",!0):$(".pricing-calendar .btn-year-prev").removeAttr("disabled")}function i(){h.selectedPeriodType=null,h.selectedPeriodId=null,h.selectedPeriodName=null,h.selectedDateRangeId=null,m=f=null,y.find(".ui-datepicker-hover").removeClass(k)}function V(){z(),b.warnings([]);var e,a=f,t=m;null===a&&P.datepicker("setDate",null),null===t&&(D.val(""),D.datepicker("option","minDate",null),D.datepicker("setDate",null)),null!==a&&null!==t&&(eviivo.webcore.datetime.utils.getDaysBetween(a,t)<0&&(e=a,a=t,t=e),P.datepicker("setDate",a),D.datepicker("option","minDate",a),D.datepicker("setDate",t)),T.find("#periodName").val(""),null==H?eviivo.webcore.ajaxHelper.executeAjax({url:eviivoSuiteApp+"/api/periods/allPeriodTypes",actionId:"getPeriodTypes",method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){q(H=e)},failCallback:function(e){console.log(e)}}):q(H)}function d(e){if(j.removeClass("active").addClass("hide"),S=e,!1===v.canAddPeriod)i();else{var a="",t=!0,r=!0;switch(e){case E.CreatePeriod:a=v.resources.PeriodCreateTitle,r=!1;break;case E.ModifyPeriod:a=v.resources.PeriodModifyTitle,t=r=!1;break;case E.AddDateRange:a=v.resources.DateRangeAddTitle;break;case E.ModifyDateRange:a=v.resources.DateRangeModifyTitle}T.find(".start-date").toggle(t),T.find(".end-date").toggle(t),T.find(".heading-title").html(a),T.find("#periodName").attr("disabled",r),$(".error").hide(),eviivo.eagle.popup.show({popupBox:T,closeButton:T.find(".s-close"),onShow:V,onClose:i})}}function s(e,a,t){if(y.find(".ui-datepicker-hover").removeClass(k),null!==e&&null!==a)for(curDate=e;curDate<=a;curDate=eviivo.webcore.datetime.utils.addDaysToDate(curDate,1))G(curDate.getMonth(),curDate.getDate(),curDate.getFullYear(),t)}function G(e,a,t,r){t=new Date(t,e,a).evStandardIso8601DateExtended();null!=x[t]&&null!=x[t]&&x[t].addClass(r)}function g(e){var a=new RegExp("[ _]","g");return"period-color-"+e.replace(a,"-").toLowerCase()}function q(e){M={},T.find(".eviivo-period-types").html(""),T.find(".eviivo-period-name input").val("");var a=null;$(".eviivo-period-types-wrap").toggle(!S);for(var t=0;t<e.length;t++){var r=e[t].Name.replace(/\s/g,""),r=$("<button>").addClass("btn btn-invert btn-grouped s-addCalendarBtnType"+e[t].Type).attr("id","btn"+r).html(e[t].Name).data("type",e[t].Type);r.attr("disabled",!1===e[t].AllowCreate||S!==E.CreatePeriod),r.prependTo(T.find(".eviivo-period-types")),null!=h.selectedPeriodType&&e[t].Type===h.selectedPeriodType&&(a=r),null==h.selectedPeriodType&&e[t].Type===function(){var e=f,a=m,t=(null===f&&(e=new Date),!0),r=!1,i=!1;for(curDate=e;curDate<=a;curDate=eviivo.webcore.datetime.utils.addDaysToDate(curDate,1)){var n=curDate.getDate(),o=curDate.getMonth(),d=curDate.getFullYear(),d=new Date(d,o,n).evStandardIso8601DateExtended();null!==N[d]&&null!=N[d]&&(N[d].type===A.Season?r=!(t=!1):N[d].type===A.Event&&(i=!(t=!1)))}return t?A.Season:(!r||!i)&&r?A.Event:A.Unknown}()&&(a=r),M[e[t].Type]=r}T.find(".eviivo-period-types button").on("click",K),null!=a&&a.trigger("click"),eviivo.pms.clone.calendar.removeSeasonEventsIfSyncCloned()}function K(){T.find(".eviivo-period-types button").removeClass("btn-active"),null!==h.periodTypes()&&(h.selectedPeriodType=$(this).data("type"),$(this).addClass("btn-active"),null!=h.selectedPeriodName&&T.find("#periodName").val(h.selectedPeriodName),u(!1))}function l(){I={},N={},eviivo.webcore.ajaxHelper.executeAjax({url:eviivoSuiteApp+"/api/periods/allPeriods",actionId:"getPeriods",method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){if(h.periodTypes([]),null===e||0===e.length)$(".pricing-settings .no-periods").removeClass("hide"),$(".pricing-settings #pnlPricingPeriods").addClass("hide"),h.periodTypes([]),y.datepicker("refresh"),setCalendarYearHeader();else{$(".pricing-settings .no-periods").addClass("hide"),$(".pricing-settings #pnlPricingPeriods").removeClass("hide");for(var a=0;a<e.length;a++){for(var t=e[a],r=0;r<t.Periods.length;r++){f=v=u=p=c=l=n=i=void 0;var i=t.Periods[r],n=t.Type,o=(I[$.parseHTML(i.Name.toLowerCase())[0].textContent]=n,i.Type=n,s=d=o=void 0,i.PeriodColor.Name),d=(i.PeriodColor.BackgroundHexCode,i.PeriodColor.TextHexCode,$("#period-styling")),s='<style id="period-styling">',o=(0!=d.length&&(s+=d.html()),"."+g(o)),s=s+("button"+o+", ")+"</style>";d.remove(),$(s).appendTo("head");for(var l=g(i.PeriodColor.Name),c=0;c<i.PeriodDateRanges.length;c++)for(var p=i.PeriodDateRanges[c],u=eviivo.webcore.datetime.parse.parseDate(p.StartDate),v=eviivo.webcore.datetime.parse.parseDate(p.EndDate);0<=eviivo.webcore.datetime.utils.getDaysBetween(u,v);){var f=u.evStandardIso8601DateExtended();null!==N[f]&&null!=N[f]?(n===A.Closure&&(N[f].type=n,N[f].className=l,N[f].periods.push(i)),n===A.Event&&N[f].type===A.Season&&(N[f].type=n,N[f].className=l,N[f].periods.push(i))):(N[f]={type:n,periods:[],className:l},N[f].periods.push(i)),u=eviivo.webcore.datetime.utils.addDaysToDate(u,1)}i.IsVisible=!0}t.IsVisible=!0,h.addPeriodType(t)}y.datepicker("refresh"),setCalendarYearHeader(),eviivo.pms.clone.calendar.checkIfCalendarIsSyncedCloned(),eviivo.pms.clone.calendar.checkIfCalendarIsSyncedMaster()}},failCallback:function(e){console.log(e)}})}function z(){b.errors([]),T.find(".period-container .mod-notice").hide(),T.find(".warning").hide()}function c(){e.not(":visible")&&e.show()}function Q(e){var t,r,a=T.find("#periodName").val(),e=""===a?(e&&(c(),T.find(".period-name-message").show()),!1):(T.find(".warning").hide(),S===E.CreatePeriod&&(h.selectedPeriodId=(t=null,r=T.find("#periodName").val().toLowerCase(),$.each(h.periodTypes(),function(e,a){a.Type===h.selectedPeriodType&&$.each(a.Periods(),function(e,a){a.Name.toLowerCase()===r&&(t=a.Id)})}),t)),!0);return e&&function(e){e=$.parseHTML(e.toLowerCase())[0].textContent;var a=null!==h.selectedPeriodName?h.selectedPeriodName.toLowerCase():null;if(null!=a&&e.trim()==a.trim()&&1==S)return!1;if(null!==I[e]&&void 0!==I[e]&&(I[e]!=h.selectedPeriodType||S==E.ModifyPeriod&&a!=e)){var t="";switch(h.selectedPeriodType){case A.Season:t=v.resources.errors.SameNameSeason;break;case A.Closure:t=v.resources.errors.SameNameClosure;break;case A.Event:t=v.resources.errors.SameNameEvent;break;default:return h.selectedPeriodType=I[e],M[h.selectedPeriodType].trigger("click"),!0}return t=(t+=" "+v.resources.errors.WithSameName)+(function(e){switch(e){case A.Season:return" "+v.resources.errors.Season;case A.Closure:return" "+v.resources.errors.Closure;case A.Event:return" "+v.resources.errors.Event;default:return" "}}(I[e])+"."),b.errors.indexOf(t)<0&&b.addError(t),!1}return!0}(a)}function X(){var e,a,t;return S===E.ModifyPeriod||(e=P.datepicker(O),a=D.datepicker(O),1825<eviivo.webcore.datetime.utils.getDaysBetween(e,a)?(t=v.resources.errors.WrongDates,b.errors.indexOf(t)<0&&b.addError(t),!1):!1===function(e,a){var t=T.find(".start-date-message"),r=T.find(".end-date-message"),t=p(e,t,v.resources.OverlapsStartDate),r=p(a,r,v.resources.OverlapsEndDate),i=!1;if(!1===t&&!1===r)for(e=eviivo.webcore.datetime.utils.addDaysToDate(e,1);1<eviivo.webcore.datetime.utils.getDaysBetween(e,a)&&!1===i;)i=p(e,null,v.resources.OverlapsStartDate),e=eviivo.webcore.datetime.utils.addDaysToDate(e,1);(i=t||r||i)&&(c(),t=v.resources.errors.Clash,b.errors.indexOf(t)<0)&&b.addError(t);return i}(e,a))}function p(e,a,t){if(null!==a&&a.hide(),null!==e){e=e.evStandardIso8601DateExtended(),e=N[e];if(null!=e&&null!==e.periods&&0!=e.periods.length)for(var r=e.periods,i=0;i<r.length;i++){var n=r[i];if(h.selectedPeriodId!==n.Id||S===E.CreatePeriod||S===E.AddDateRange)if(n.Type===A.Closure&&h.selectedPeriodType!==A.Closure)null!==a&&(a.html($.validator.format(t,n.Name)),a.show());else if(n.Type===h.selectedPeriodType)return null!==a&&(a.html($.validator.format(t,n.Name)),a.show()),!0}return!1}}function u(e){z();var a=S!==E.ModifyPeriod,e=Q(e),t=null===h.selectedPeriodType?(c(),T.find(".period-type-message").show(),!1):(T.find(".period-type-message").hide(),!0),r=!a||X(),t=t&&e&&r;return t?T.find("#add-period").removeAttr("disabled"):T.find("#add-period").attr("disabled",!0),a&&(e=t)&&h.selectedPeriodType===A.Closure&&null!=P.datepicker("getDate")&&null!=D.datepicker("getDate")&&(e=P.datepicker(O),r=D.datepicker(O),null!=e)&&null!=r&&(e={Type:h.selectedPeriodType,StartDate:e.evStandardIso8601DateExtended(),EndDate:r.evStandardIso8601DateExtended()},eviivo.webcore.ajaxHelper.executeAjax({url:eviivoSuiteApp+"/api/periods/doBookingsExist",data:e,actionId:"doBookingsExistForPeriodDateRange",method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){var a=v.resources.warnings.BookingsExist,t=b.warnings.indexOf(a);!0===e?t<0&&b.addWarning(a):0<=t&&b.removeWarning(a)}})),t}function Z(){var e,a;u(!0)&&(e=!0,j.removeClass("hide").addClass("active"),a={Type:h.selectedPeriodType,PeriodId:h.selectedPeriodId,Name:T.find(".eviivo-period-name input").val()},S!==E.ModifyPeriod&&S!==E.ModifyDateRange||(e=!1),S!==E.ModifyPeriod&&(a.DateRangeId=h.selectedDateRangeId,a.StartDate=P.datepicker(O).evStandardIso8601DateExtended(),a.EndDate=D.datepicker(O).evStandardIso8601DateExtended()),_.attr("disabled",!0),_.addClass("btn-saving"),_.find(".btn-text").css("opacity","0"),_.find(".btn-spinner").removeClass("hidden"),e?eviivo.webcore.ajaxHelper.executeAjax({url:eviivoSuiteApp+"/api/periods/add",data:a,actionId:"addPeriod",method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:te,failCallback:function(e){console.log(e)}}):eviivo.webcore.ajaxHelper.executeAjax({url:eviivoSuiteApp+"/api/periods/modify",data:a,actionId:"modifyPeriod",method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:te,failCallback:function(e){console.log(e)}}))}function ee(){j.removeClass("hide").addClass("active");var e={Type:h.selectedPeriodType,PeriodId:h.selectedPeriodId,DateRangeId:h.selectedDateRangeId};eviivo.webcore.ajaxHelper.executeAjax({url:eviivoSuiteApp+"/api/periods/delete",data:e,actionId:"deletePeriod",method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:ae,failCallback:function(e){console.log(e)}})}function ae(e){null!==e&&!0===e&&(l(),eviivo.eagle.popup.hide(),j.removeClass("hide").addClass("active"))}function te(e){if(_.attr("disabled",!1),_.removeClass("btn-saving"),_.find(".btn-text").css("opacity","1"),_.find(".btn-spinner").addClass("hidden"),null!==e)if(null===e.PricingPeriodError)l(),eviivo.eagle.popup.hide(),j.removeClass("active").addClass("hide");else{var a="";switch(e.PricingPeriodError){case t.SeasonOverSeason:a=v.resources.errors.SeasonOverlapErrorMessage;break;case t.EventOverEvent:a=v.resources.errors.EventOverlapErrorMessage;break;case t.ClosureOverClosure:a=v.resources.errors.ClosureOverlapErrorMessage;break;case t.DuplicateName:a=v.resources.errors.SameNameEvent+" "+v.resources.errors.WithSameName+" "+v.resources.errors.Event}b.errors.indexOf(a)<0&&b.addError(a)}}var v,y,re,f,m,w,h,b,T,C,P,D,S,I,ie,k,x,N,A,t,E,M,O,e,j,H,_;window.eviivo=window.eviivo||{},window.eviivo.eagle=window.eviivo.eagle||{},window.eviivo.eagle.pricingCalendar=window.eviivo.eagle.pricingCalendar||{},window.eviivo.eagle.pricingCalendar=(ie=100,k="ui-datepicker-hover",x={},N={},A={Unknown:0,Closure:1,Event:2,Season:3},t={Unknown:0,SeasonOverSeason:1,EventOverEvent:2,ClosureOverClosure:3,DuplicateName:4},E={CreatePeriod:0,ModifyPeriod:1,AddDateRange:2,ModifyDateRange:3},M={},O="getDate",e=$(".period-container .mod-notice"),j=$(".s-popup-spinner"),H=null,_=$("#add-period"),setCalendarYearHeader=function(){var e=$(".ui-datepicker-title > span.ui-datepicker-year:first").html(),a=$(".ui-datepicker-title > span.ui-datepicker-year:last").html();a!=e&&(e+=" - "+a),$(".pricing-calendar .nav-year .text-year").html(e)},{init:function(e){var a,t;v=$.extend(v,e),h=new R,ko.applyBindings(h,document.getElementById("pnlPricingPeriods")),b=new L,ko.applyBindings(b,document.getElementById("popup-add-period")),m=f=null,w="#periods-calendar .ui-datepicker-calendar td[class!='ui-datepicker-other-month']",e=[4,3],1024<$(window).width()&&(e=[3,4]),a=(new Date).evStandardFirstDayCalendarOffset(eviivo.eagle.basePageModelState.userCultureCode),t=e[0]*e[1],y=$("#periods-calendar"),y=eviivo.webcore.calendar.init(eviivo.webcore.calendar.CALENDAR_TYPE.initYearCalendar,{defaultCultureCode:eviivo.eagle.basePageModelState.userCultureCode,calendar:y,numberOfMonths:e,showOtherMonths:!0,stepMonths:t,firstDay:a,beforeShowDay:function(e){var e=e.evStandardIso8601DateExtended(),a=[];return a[0]=!0,a[1]=null!=N[e]&&null!=N[e]?N[e].className:"",a[2]="",a},onChangeMonthYear:function(e,a,t){W(),l()},onSelect:function(e,a){var t;null===f?(f=new Date(a.currentYear,a.currentMonth,a.currentDay,0,0,0),setTimeout(function(){U(),G(a.currentMonth,a.currentDay,a.currentYear,k),r()},0)):null===m&&((m=new Date(a.currentYear,a.currentMonth,a.currentDay,0,0,0))<f&&(t=m,m=f,f=t),0!==eviivo.webcore.datetime.utils.getDaysBetween(f,m)?(setTimeout(function(){var e,a;U(),a=m,null!==(e=f)&&null!==a&&s(e,a,k)},0),d(E.CreatePeriod)):setTimeout(i,0))}}),re=(new Date).getFullYear(),setTimeout(r,0),setCalendarYearHeader(),$(".pricing-calendar .btn-year-prev").on("click",function(){y.find(".ui-datepicker-prev").trigger("click")}),$(".pricing-calendar .btn-year-next").on("click",function(){y.find(".ui-datepicker-next").trigger("click")}),l(),W(),v.canAddPeriod&&(T=$("#popup-add-period"),$("#new-season-btn").on("click",function(){d(E.CreatePeriod)}),e=(new Date).evStandardFirstDayCalendarOffset(eviivo.eagle.basePageModelState.userCultureCode),(P=T.find("#periodStartDate")).datepicker("hide"),P=eviivo.webcore.calendar.init(eviivo.webcore.calendar.CALENDAR_TYPE.initCalendar,{defaultCultureCode:eviivo.eagle.basePageModelState.userCultureCode,calendar:P,dateFormat:eviivo.eagle.dateFormat.getDateFormat("LONG_DATE_FORMAT"),showOtherMonths:!0,changeYear:!0,firstDay:e,changeMonth:!0,doNotSetInitialDate:!0,onSelect:function(){var e=P.datepicker(O);D.datepicker("option","minDate",e),u(!1)&&s(f=e,m,k)}}),(D=T.find("#periodEndDate")).datepicker("hide"),D=eviivo.webcore.calendar.init(eviivo.webcore.calendar.CALENDAR_TYPE.initCalendar,{defaultCultureCode:eviivo.eagle.basePageModelState.userCultureCode,calendar:D,dateFormat:eviivo.eagle.dateFormat.getDateFormat("LONG_DATE_FORMAT"),showOtherMonths:!0,changeYear:!0,changeMonth:!0,minDate:0,firstDay:e,doNotSetInitialDate:!0,onSelect:function(){var e=D.datepicker(O);u(!1)&&s(f,m=e,k)}}),T.find("#add-period").on("click",Z),T.find("#cancel-add-period").on("click",eviivo.eagle.popup.hide),T.find("#periodName").on("input",u),T.find("#periodName").attr("maxlength",ie)),(C=$("#popup-delete-period")).find("#delete-period").on("click",ee),C.find("#cancel-delete-period").on("click",eviivo.eagle.popup.hide),C.find("#ok-cancel-delete-period").on("click",eviivo.eagle.popup.hide),$(".s-draggable").draggable({handle:".s-drag-handle",height:"auto",cancel:".s-cancel",start:function(){$(".ui-autocomplete").is(":visible")&&$(".ui-autocomplete").hide()}}),eviivo.pms.clone.calendar.manageIndependentSuccess()}})}},r={};function i(e){var a=r[e];return void 0!==a||(a=r[e]={exports:{}},t[e](a,a.exports,i)),a.exports}i.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(a,{a:a}),a},i.d=function(e,a){for(var t in a)i.o(a,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},i.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},function(){"use strict";i(3348),i(3640)}();
//# sourceMappingURL=pricingCalendar.min.js.map