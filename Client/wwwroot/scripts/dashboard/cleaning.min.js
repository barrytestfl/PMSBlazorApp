var o={8211:function(){window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},eviivo.pms.diary=eviivo.pms.diary||{},eviivo.pms.diary.calendarNavigator=eviivo.pms.diary.calendarNavigator||{},window.eviivo.pms.diary.calendarNavigator=function(){var o,t,i,a=this,n={},l={backButton:"#diary-back-button",backBackButton:"#diary-back-back-button",calendarButton:"#diary-datepicker",goTodayButton:"#diary-go-today-button",forwardButton:"#diary-forward-button",forwardForwardButton:"#diary-forward-forward-button",todayButton:"#ui-datepicker-div .ui-datepicker-current",revertToTodayButton:"#diary-go-today-button",datePickerMask:"#diary-datepicker-mask"},s={body:null,backButton:null,backBackButton:null,calendarButton:null,goTodayButton:null,forwardButton:null,forwardForwardButton:null,todayButton:null,revertToTodayButton:null,datePickerMask:null},r=null,c="eviivo.pms.diary.calendarNavigator";function d(){return function(e){i.call(a,e),a._selectDate(e)}}return{init:function(e){if("function"!=typeof jQuery)throw c+": module depends on jQuery";o=(t=jQuery).extend(n,e),r={click:eviivo.util.namespacedEvent("click",c),focus:eviivo.util.namespacedEvent("focus",c)},s.backBackButton=t(l.backBackButton),s.backButton=t(l.backButton),s.calendarButton=t(l.calendarButton),s.goTodayButton=t(l.goTodayButton),s.forwardButton=t(l.forwardButton),s.forwardForwardButton=t(l.forwardForwardButton),s.todayButton=t(l.todayButton),s.datePickerMask=t(l.datePickerMask),s.revertToTodayButton=t(l.revertToTodayButton),null!=o.actions&&(s.backBackButton.on(r.click,o.actions.backBack),s.backButton.on(r.click,o.actions.back),$(document).off("click",".ui-datepicker-buttonpane button[data-handler='today']").on("click",".ui-datepicker-buttonpane button[data-handler='today']",o.actions.goToday),s.revertToTodayButton.on(r.click,o.actions.goToday),s.forwardButton.on(r.click,o.actions.forward),s.forwardForwardButton.on(r.click,o.actions.forwardForward),s.datePickerMask.on(r.click,function(){s.calendarButton.datepicker("show")})),e=(new Date).evStandardFirstDayCalendarOffset(eviivo.eagle.basePageModelState.userCultureCode),s.calendarButton=eviivo.webcore.calendar.init(eviivo.webcore.calendar.CALENDAR_TYPE.initCalendar,{defaultCultureCode:eviivo.eagle.basePageModelState.userCultureCode,calendar:s.calendarButton,yearRange:"-4:+5",dateFormat:eviivo.eagle.dateFormat.getDateFormat("SHORT_YEAR"),changeMonth:!0,changeYear:!0,showButtonPanel:!0,altFormat:eviivo.eagle.dateFormat.getDateFormat("NO_YEAR"),altField:l.datePickerMask,firstDay:e,updtStDtQueryOnChange:!0,updtStDtPersistentElementsOnChange:!0,onSelect:function(e,t){var t=new Date(t.selectedYear,t.selectedMonth,parseInt(t.selectedDay),0,0,0);t=t,"function"==typeof o.actions.dateSelection&&o.actions.dateSelection(t)}}),i=t.datepicker._gotoToday,eviivo.webcore.functions.compare(d,i)&&(t.datepicker._gotoToday=d)},setDate:function(e){null!=s.calendarButton&&s.calendarButton.datepicker("setDate",e)}}}()},4301:function(){function a(o,e,t,i,a){eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".UpdateCleaningItem",url:"/suite/api/Cleaning/UpdateCleaningItem",method:eviivo.webcore.ajaxHelper.methods.POST,data:{ItemStatusId:o,ItemDate:eviivo.webcore.datetime.evStandardIso8601DateExtended(e),RoomId:t,ItemStatusCode:i},contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){var t=f.row(a).data();null==o&&(t.CleaningItemId=e.Id),t.Status=e.CleaningStatusCode,t.Condition=e.Condition,t.StatusTime=e.UpdatedTime,t.Assigned=e.DisplayName,eviivo.component.listing.refreshRow(f,a),u(C.resources.GenericSave)},failCallback:function(e,t,o,i){d(C.resources.GenericError)}})}function n(o,e,t,i,a,n){eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".UpdateAssignedTo",url:"/suite/api/Cleaning/UpdateAssignedTo",method:eviivo.webcore.ajaxHelper.methods.POST,data:{RoomCleaningAssigneeId:i,AssigneeUserId:e,ItemRoomId:t,AssigneeName:null==e?o:null,ItemDate:eviivo.webcore.datetime.evStandardIso8601DateExtended(p())},contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){var t=f.row(a).data();null==i&&(t.RoomCleaningAssigneeId=e.id),t.Assigned=o,eviivo.component.listing.refreshRow(f,a),eviivo.component.listing.filter.updateColumnFilter(f,n),u(C.resources.GenericSave)},failCallback:function(e,t,o,i){d(C.resources.GenericError)}})}function d(e){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.error,message:e})}function u(e){eviivo.webcore.notifier.show({type:eviivo.webcore.notifier.types.success,message:e})}function o(){$(".cp-multi-input_menu").removeClass("show")}function t(e){eviivo.pms.diary.calendarNavigator.setDate(p(e))}function p(e){return null!=e?new Date($("#diary-datepicker").datepicker("getDate").addDays(e)):$("#diary-datepicker").datepicker("getDate")}function i(e){eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".getNewDateDataAndRender",url:"/suite/api/Cleaning/cleaninglistWithDate",method:eviivo.webcore.ajaxHelper.methods.POST,data:{DateFrom:eviivo.webcore.datetime.evStandardIso8601DateExtended(e)},contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){eviivo.component.listing.updateDataTableInformation(f,e)},failCallback:function(e,t,o,i){d(C.resources.GenericError)}}),$(I.bulkUpdateOptionSchedule+' option[value="NOW"]').prop("disabled",e.valueOf()!=(new Date).setHours(0,0,0,0).valueOf())}function l(){var e=f.rows({filter:"applied"}).data().toArray();eviivo.webcore.navigatorHelper.redirectTo("cleaning/print",e,eviivo.webcore.navigatorHelper.options.target.newWindow,eviivo.webcore.navigatorHelper.options.method.post)}function s(){$("."+h.bedConfigDropdown).off("change").on("change","",function(e){var o,i,a,t=e.target.value,e=e.target.selectedOptions[0].text,n=$(this).closest("tr")[0],l=v(n,this),s=($(n).hasClass("child")&&(n=$(n).prev()),f.row(n).data());s=s.BookingId,o=e,i=n,a=l,eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".UpdateBedConfigurations",url:"/suite/api/Cleaning/UpdateBedConfigurations",method:eviivo.webcore.ajaxHelper.methods.POST,data:{BookingId:s,RoomTypeBedConfig:t},contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){var t=f.row(i).data();null!=t&&(t.BedConfig=o),eviivo.component.listing.refreshRow(f,i),eviivo.component.listing.filter.updateColumnFilter(f,a),u(C.resources.GenericSave)},failCallback:function(e,t,o,i){d(C.resources.GenericError)}})}),$("."+h.statusIcon).off("click").on("click",function(e){var t=$(this).closest("tr")[0],o=($(t).hasClass("child")&&(t=$(t).prev()),f.row(t).data()),i=o.Status;i===C.constants.cleaningStatus.CLEANING_REQUIRED||i===C.constants.cleaningStatus.CLEANING_NOT_REQUIRED?a(o.CleaningItemId,p(),o.RoomId,C.constants.cleaningStatus.CLEANED,t):i===C.constants.cleaningStatus.CLEANED&&(a(o.CleaningItemId,p(),o.RoomId,C.constants.cleaningStatus.CLEANING_REQUIRED,t),$(".cp-tooltip-custom").remove())}),$("."+h.scheduleDropdown).off("change").on("change","",function(e){var o,t,i,a,n,l=e.target.value,e=e.target.selectedOptions[0].text,s=$(this).closest("tr")[0],r=v(s,this),c=($(s).hasClass("child")&&(s=$(s).prev()),f.row(s).data());o=c.ItemScheduleId,c=c.RoomId,t=p(),l=l,i=e,a=s,n=r,eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".UpdateSchedule",url:"/suite/api/Cleaning/UpdateSchedule",method:eviivo.webcore.ajaxHelper.methods.POST,data:{ItemScheduleId:o,RoomId:c,ItemPropertyDate:eviivo.webcore.datetime.evStandardIso8601DateExtended(t),ScheduleTypeCode:"null"===l?null:l},contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){var t=f.row(a).data();null==o&&(t.ItemScheduleId=e.id),t.Schedule=i,eviivo.component.listing.refreshRow(f,a),eviivo.component.listing.filter.updateColumnFilter(f,n),u(C.resources.GenericSave)},failCallback:function(e,t,o,i){d(C.resources.GenericError)}})}),$("."+h.notesIcon).off("click").on("click",function(e){var t=$(this).closest("tr")[0],o=($(t).hasClass("child")&&(t=$(t).prev()),f.row(t).data());(y=o).rowId=t,eviivo.component.flyout.showFlyoutWithCallback("Notes",m)}),$("."+h.assignToInput).off("change").on("change",function(e){var t=e.target.value,e=$(this).closest("tr")[0],o=v(e,this),i=($(e).hasClass("child")&&(e=$(e).prev()),f.row(e).data()),a=i.AssignedOptions.find(function(e){return e.Text==t});return n(t,a?a.Value:null,i.RoomId,i.RoomCleaningAssigneeId,e,o)}),$(".s-option").off("click").on("click",function(e){$(this).closest("div").find("."+h.assignToInput).val($(this).text()).change(),o()}),$(".s-btn-remove").off("click").on("click",function(){$(this).siblings("input."+h.assignToInput).val("").trigger("change")}),$("."+h.alertIcon).off("click").on("click",function(e){var t,o,i=$(this).closest("tr")[0],i=($(i).hasClass("child")&&(i=$(i).prev()),f.row(i).data());t=i.RoomId,o=p(),i=i.BusinessId,$("#loading-overlay").show(),eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".UpdateCleaningItem",url:"/suite/api/Cleaning/SendCleaningItemAlert",method:eviivo.webcore.ajaxHelper.methods.POST,data:{ItemDate:eviivo.webcore.datetime.evStandardIso8601DateExtended(o),RoomId:t,BusinessId:i},contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){$("#loading-overlay").hide(),u(C.resources.EmailSent)},failCallback:function(e,t,o,i){$("#loading-overlay").hide(),d(C.resources.GenericError)}})})}function v(e,t){return $(e).hasClass("child")?null:f.cell($(t).closest("td")).index().column}function r(){eviivo.component.flyout.showFlyout("ColumnSelection")}function c(){eviivo.component.flyout.showFlyout("BulkActions")}function g(e,o,t){var i="cp-custom-select_table s-column-select ",a=(null!=t&&(i+=t),'<select class="'+i+'">');return null!=e&&e.forEach(function(e){var t=e.Text==o||e.Value==o?"selected=selected":"";a+='<option value="'+e.Value+'" '+t+">"+e.Text+"</option>"}),a+="</select >"}function m(){$(I.cleaningInstructions).prop("disabled",!C.permissions.editableCleaningInstructions||0==y.BookingId),$(I.todayCleaningInstructions).prop("disabled",!C.permissions.editableCleaningInstructions),$(I.enableRepairs).prop("checked",!1),$(I.enableRepairs).prop("disabled",!1),$(I.repairNotes).prop("disabled",!1),$(I.couldNotCleanCheckbox).prop("checked",!1),$("label[for="+I.enableRepairs.substring(1)+"]").attr("data-tooltip-title",""),$(I.cleaningInstructions).val(null),$(I.todayCleaningInstructions).val(null),$(I.cleaningNotes).val(null),$(I.couldNotCleanReason).val(null),$(I.repairNotes).val(null),null!=y&&($("#Notes "+I.flyoutHeading).html(y.Unit+" - "+eviivo.webcore.datetime.evDisplayMediumDate($("#diary-datepicker").datepicker("getDate"),eviivo.eagle.basePageModelState.userCultureCode)),$(I.cleaningInstructions).val(eviivo.webcore.html.decode(y.CleaningInstructions)),$(I.cleaningNotes).val(eviivo.webcore.html.decode(y.CleaningNotes)),$(I.couldNotCleanReason).val(y.CouldntCleanReason),$(I.repairNotes).val(eviivo.webcore.html.decode(y.RepairNotes)),$(I.todayCleaningInstructions).val(eviivo.webcore.html.decode(y.TodaysCleaningInstructions)),$(I.enableRepairs).prop("checked",y.RepairRequired),y.Status==C.constants.roomStatus.BLOCKED&&y.RepairRequired&&($(I.enableRepairs).prop("disabled",y.RepairRequired),$("label[for="+I.enableRepairs.substring(1)+"]").attr("data-tooltip-title",C.resources.MaintBlocked)),y.RepairRequired||$(I.repairNotes).prop("disabled",!0)),$(I.enableRepairs).off().on("click",function(e){$(I.repairNotes).prop("disabled",!e.target.checked)})}var C,b,f,h,I,y,w;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.cleaning=window.eviivo.pms.cleaning||{},window.eviivo.pms.cleaning=(C={},b="eviivo.pms.cleaning",f={},h={multiProperty:{applyButton:".save-multiProperty"},bedConfigDropdown:"bedConfigSelect",assignToInput:"assignTo",scheduleDropdown:"scheduleSelect",statusIcon:"status",notesIcon:"s-toggle-flyout[data-target=notes-flyout]",alertIcon:"alert",listTable:"#eviivo-list-cleaning"},I={flyoutHeading:".s-heading-title",cleaningNotes:"#cleaningNotes",cleaningInstructions:"#routineInstructions",todayCleaningInstructions:"#routineInstructionsToday",couldNotCleanCheckbox:"#cnc-check",couldNotCleanReason:"#cnc-reason",enableRepairs:"#enable-repairs",repairNotes:"#repairNotes",form:"#NotesFlyoutForm",bulkUpdateOption:"#bulkUpdateOption",bulkUpdateOptionSchedule:"#bulkUpdateOptionSchedule"},y={},w=[],{init:function(e){C=eviivo.util.extend(C,e),$("#diary-back-back-button").addClass("hide"),$("#diary-forward-forward-button").addClass("hide"),$(".cp-date-controls").addClass("cp-date-controls_single-directions"),eviivo.pms.diary.calendarNavigator.init({hideDatepickerAfterDateUpdated:!0,actions:{back:function(){t(-1),i(p())},goToday:function(){eviivo.pms.diary.calendarNavigator.setDate(new Date),i(p())},forward:function(){t(1),i(p())},dateSelection:function(e){eviivo.pms.diary.calendarNavigator.setDate(e),i(p())}}}),$("body").tip(),$(".s-switch").on("change",function(){var e=$(this),t=e.data("column"),o=e.is(":checked"),t=f.column("."+t);t.visible(o),o&&eviivo.component.listing.filter.dynamicallyAppendFilterSelectDropdown(f,t.index()),t=e.data("columnkey"),eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".ColumnConfigurations",url:"/suite/api/Cleaning/ColumnConfigurations",method:eviivo.webcore.ajaxHelper.methods.POST,data:{Column:t,Status:o},contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){u(C.resources.ColumnSaveSuccessMessage)},failCallback:function(e,t,o,i){d(C.resources.GenericError)}})}),$("body").on("click focus",".cp-multi-input > input",function(){var e,t,o,i,a=$(this);e=(a=a).position(),t=e.left,e=e.top,o=a.next(),i=$(window),$(".cp-multi-input_menu").removeClass("show"),o.css({top:e+a.height()+2-i.scrollTop(),left:t-i.scrollLeft()}).addClass("show")}),$(document).on("mouseup",function(e){var t=$(".s-multi-input");$(".cp-multi-input_menu");t.is(e.target)||0!==t.has(e.target).length||o()}),$(document).on("scroll",function(){o()}),eviivo.pms.listingTable.filterActions.init({table:"eviivo-list-cleaning",callback:function(){eviivo.component.listing.postInitRefreshDataTableSpecific(h.listTable)}})},onBeforeListDataLoad:function(){},onSuccessListDataLoad:function(e){f=e,eviivo.component.flyout.init({}),e='<div class="s-toggle-flyout cp-table_toolbar-action" data-target="columns-flyout"><svg class="icon-ic-gear"><use xlink:href="#icon-ic-gear"></use></svg><span>'+C.resources.ButtonColumns+"</span></div>",$("div.cp-table_toolbar-actions").html('<div id="printButton" class="s-print cp-table_toolbar-print cp-table_toolbar-action"><svg class="icon-ic-printer"><use xlink:href="#icon-ic-printer"></use></svg></div>'+e),f.on("draw",function(){s()}),eviivo.component.handlers.assign(".s-toggle-flyout[data-target=columns-flyout]",r,"click"),eviivo.component.handlers.assign(".s-toggle-flyout[data-target=bulk-flyout]",c,"click"),eviivo.component.handlers.assign("#printButton",l,"click"),$(document).on("click",h.multiProperty.applyButton,function(){i(p())}),s(),$.fn.dataTableExt.oSort["Guests-desc"]=function(e,t){return e[0]==t[0]?e[1]<t[1]:e[0]<t[0]},$.fn.dataTableExt.oSort["Guests-asc"]=function(e,t){return e[0]==t[0]?e[1]>t[1]:e[0]>t[0]},$.fn.dataTableExt.oSort["Unit-desc"]=function(e,t){return e.localeCompare(t,eviivo.eagle.basePageModelState.userCultureCode,{numeric:!0,ignorePunctuation:!0})},$.fn.dataTableExt.oSort["Unit-asc"]=function(e,t){return t.localeCompare(e,eviivo.eagle.basePageModelState.userCultureCode,{numeric:!0,ignorePunctuation:!0})}},customRenderMovement:function(e,t,o){return o.Movement},customRenderNights:function(e,t,o){return 0===o.CurrentNight&&0===o.TotalNights?"":o.CurrentNight+" "+C.resources.Of+" "+o.TotalNights},customRenderBedConfig:function(e,t,o){return"display"===t?0===o.BookingId||null==o.BedConfigOptions||0==o.BedConfigOptions.length?"":C.permissions.bedConfigColumnEditable?g(o.BedConfigOptions,e,h.bedConfigDropdown):e:e},customRenderExtras:function(e,t,o){var i;return"display"===t?1==e?(i="<ul class='list-normal'>",o.ExtrasList.forEach(function(e){return i+="<li class='align-left'>".concat(e,"</li>")}),'<svg class="icon-ic-beer-bottle" data-tooltip="title" data-tooltip-pos="bottom" title="" data-tooltip-title="'+(i+="<ul>")+'"> <use xlink: href="#icon-ic-beer-bottle"></use></svg >'):"":e},customRenderSchedule:function(t,e,o){return"display"===e?0==o.ScheduleOptions.length?"":(e=o.ScheduleOptions.filter(function(e){return e.Text==t})[0],C.permissions.editableScheduleColumn?o.Status==C.constants.roomStatus.BLOCKED?"":g(o.ScheduleOptions,t,h.scheduleDropdown):null==e?"":e.Text):t},customRenderNotes:function(e,t,o){var i;return"display"==t?(t="",o.RepairRequired||null!=o.CleaningNotes&&""!=o.CleaningNotes||null!=o.CleaningInstructions&&""!=o.CleaningInstructions||null!=o.TodaysCleaningInstructions&&""!=o.TodaysCleaningInstructions?o.RepairRequired&&(null!=o.CleaningNotes&&""!=o.CleaningNotes||null!=o.CleaningInstructions&&""!=o.CleaningInstructions||null!=o.TodaysCleaningInstructions||""!=o.TodaysCleaningInstructions)?t+='<button class="cp-table_action  s-toggle-flyout"title="'+(i=null==o.RepairNotes||""==o.RepairNotes?"":o.RepairNotes)+'"data-tooltip="title"data-tooltip-title="'+i+'"data-tooltip-pos="top"data-target="notes-flyout" > <svg class="icon-ic-wrench" > <use xlink: href="#icon-ic-wrench"></use></svg > </button>':t=o.RepairRequired?'<button class="cp-table_action  s-toggle-flyout"title="'+(i=null==o.RepairNotes||""==o.RepairNotes?"":o.RepairNotes)+'" data-tooltip="title" data-tooltip-title="'+i+'" data-tooltip-pos="top" data-target="notes-flyout"><svg class="icon-ic-wrench" > <use xlink: href="#icon-ic-wrench"></use></svg></button>':'<button class="cp-table_action s-toggle-flyout" data-target="notes-flyout"><svg class="icon-ic-note"><use xlink: href="#icon-ic-note"></use></svg></button>':t='<button class="cp-table_action  s-toggle-flyout empty-note" data-target="notes-flyout"><svg class="icon-ic-note-pencil"><use xlink: href="#icon-ic-note-pencil"></use></svg></button>',t):e},customRenderAssigned:function(e,t,o){var i,a;return C.permissions.assignToColumnEditable&&"display"===t?(i=""!=(t=null==e?"":e)?'<a href="javascript:;" class="s-btn-remove btn-remove icon-red"><svg class="icon-ic-x"><use xlink: href="#icon-ic-x"></use></svg></a>':"",0<o.AssignedOptions.length?(a='<div class="cp-multi-input cp-multi-input_table cp-multi-input_hidden-input s-multi-input relative"><input type="text" class="assignTo" autocomplete="off" id="assignTo" placeholder="'+C.resources.AssignPlaceholder+'" value="'+t+'" /><ul class="cp-multi-input_menu">',o.AssignedOptions.forEach(function(e){a+='<li class="s-option">'+e.Text+"</li>"}),a+="</ul>"+i+"</div>"):'<div class="cp-multi-input cp-multi-input_table cp-multi-input_hidden-input s-multi-input relative"><input type="text" class="assignTo" id="assignTo" placeholder="'+C.resources.AssignPlaceholder+'" value="'+t+'" />'+i):e},customRenderStatus:function(e,t,o){var i,a="";return e===C.constants.cleaningStatus.CLEANING_REQUIRED||e===C.constants.cleaningStatus.CLEANING_NOT_REQUIRED?a='<button class="cp-table_action status hide-for-tablet-p"><svg class="icon-ic-broom" > <use xlink: href="#icon-ic-broom"></use></svg ></button>':e===C.constants.cleaningStatus.CLEANED?(i=new Date(o.StatusTime),a='<div class="display-flex align-items-center status "><svg class="icon-ic-checkmark-large" data-tooltip="title" data-tooltip-pos="top" title="'+C.resources.CleaningStatusUndo+'" data-tooltip-title="'+C.resources.CleaningStatusUndo+'"><use xlink:href="#icon-ic-checkmark-large"></use></svg><span class="time-complete">'+i.evDisplayShortTime(eviivo.eagle.basePageModelState.userCultureCode)+"</span></div>"):e===C.constants.cleaningStatus.COULD_NOT_CLEAN?(i=new Date(o.StatusTime),a='<div class="display-flex align-items-center status "><svg class="icon-ic-prohibit" data-tooltip="title" data-tooltip-pos="top" title="'+C.resources.CouldNotCleanReasons[o.CouldntCleanReason]+'" data-tooltip-title="'+C.resources.CouldNotCleanReasons[o.CouldntCleanReason]+'"><use xlink: href="#icon-ic-prohibit"></use></svg><span class="time-complete">'+i.evDisplayShortTime(eviivo.eagle.basePageModelState.userCultureCode)+"</span></div>"):e===C.constants.cleaningStatus.BLOCKED&&(a='<div class="display-flex align-items-center status blocked"><svg class="icon-ic-prohibit"><use xlink: href="#icon-ic-prohibit"></use></svg></div>'),a},customRenderGuests:function(e,t,o){return"display"===t?Array.isArray(e)?(t="",0<e[0]&&(t=(t+=e[0]+" ")+(1==e[0]?C.resources.GuestsAdult:C.resources.GuestsAdults)),"<span>"+(t=0<e[1]?(t+=", "+e[1]+" ")+(1==e[1]?C.resources.GuestsChild:C.resources.GuestsChildren):t)+"</span>"):"":e},customRenderAlert:function(e,t,o){if("display"===t){t=o.AssignedOptions.find(function(e){return e.Text==o.Assigned});if(null!=o.Assigned&&null!=t&&C.permissions.enabledCleaningAlerts)return'<button class="cp-table_action alert" data-tooltip-pos="left" title="'+C.resources.sendAlert+'" data-tooltip-title="'+C.resources.sendAlert+'" data-tooltip="title"><svg class="icon-ic-bell-ringing"><use xlink:href="#icon-ic-bell-ringing"></use></svg></button>'}return""},customRender:function(e,t,o){return""},createdRowCallback:function(e,t,o,i,a){$("table thead tr").eq(0).find("th");for(var n,l=0;l<i.length;l++)0==l&&a.enableBulkSelect||(n=eviivo.component.listing.getColumnHeaderInfo(a.tableName,l),i[l].setAttribute("data-title",n.text()+":"))},NotesFlyoutIsLoadedCallback:m,NotesFlyoutSave:function(){var e={itemStatusId:y.CleaningItemId,itemDate:eviivo.webcore.datetime.evStandardIso8601DateExtended(p()),roomId:y.RoomId,cleaningNotes:$(I.cleaningNotes).val(),CleaningNoteId:y.CleaningNoteId,couldntClean:""!=$(I.couldNotCleanReason).val(),couldntCleanReasonCode:$(I.couldNotCleanReason).val(),maintenanceNoteId:y.RepairId,maintenanceRequired:$(I.enableRepairs).prop("checked"),maintenanceNotes:$(I.repairNotes).val(),todaysCleaningInstructions:$(I.todayCleaningInstructions).val(),routineInstructions:{noteId:y.CleaningInstructionsId,bookingId:y.BookingId,note:null==y.BookingId?null:$(I.cleaningInstructions).val()}};eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".UpdateCleaningNotes",url:"/suite/api/Cleaning/UpdateCleaningNotes",method:eviivo.webcore.ajaxHelper.methods.POST,data:e,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){var t=f.row(y.rowId).data();t.CouldntCleanReason=e.CouldntCleanReasonCode,t.TodaysCleaningInstructions=e.TodaysCleaningNotes,null!=e.CleaningItemStatus&&(t.Status=e.CleaningItemStatus.CleaningStatusCode,t.StatusTime=e.CleaningItemStatus.StatusTimeStamp,t.CleaningNotes=e.CleaningNotes,t.CleaningNoteId=e.CleaningNoteId,t.CouldntClean=e.CleaningItemStatus.CleaningStatusCode==C.constants.cleaningStatus.COULD_NOT_CLEAN),null!=e.MaintenanceStatus&&(t.RepairId=e.MaintenanceStatus.Id,t.RepairNotes=e.MaintenanceStatus.MaintenanceNote,t.RepairRequired=e.MaintenanceStatus.MaintenanceRequired),null!=e.BookingCleaningData&&(t.CleaningInstructionsId=e.BookingCleaningData.RoutineInstructionsId,t.CleaningInstructions=e.BookingCleaningData.RoutineInstructions),eviivo.component.listing.refreshRow(f,y.rowId),eviivo.component.listing.filter.updateColumnFilter(f,f.columns().toArray()[0]),u(C.resources.GenericSave),eviivo.component.flyout.hideAllFlyouts()},failCallback:function(e,t,o,i){d(C.resources.GenericError)}})},OnRowSelectedDeselectedCallback:function(e){w=e,$("#bulkEdit").prop("disabled",e.length<2)},BulkActionsSave:function(){var t;""==$(I.bulkUpdateOption).val()&&""==$(I.bulkUpdateOptionSchedule).val()||($("#loading-overlay").show(),t=[],w.forEach(function(e){e=f.row(e).data();t.push({ItemStatusId:e.CleaningItemId,ItemDate:eviivo.webcore.datetime.evStandardIso8601DateExtended(p()),RoomId:e.RoomId,ItemStatusCode:$(I.bulkUpdateOption).val(),ItemScheduleId:e.ItemScheduleId,ItemScheduleCode:$(I.bulkUpdateOptionSchedule).val()==C.constants.cleaningScheule.NO_SCHEDULE?null:$(I.bulkUpdateOptionSchedule).val()})}),eviivo.webcore.ajaxHelper.executeAjax({actionId:b+".BulkUpdateCleaningItems",url:"/suite/api/Cleaning/BulkUpdateCleaningItems",method:eviivo.webcore.ajaxHelper.methods.POST,data:t,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){for(var t=0;t<w.length;t++){var o=w[t],i=f.row(o).data();i.CleaningItemId=e[t].Id,i.Status=e[t].CleaningStatusCode,i.Condition=e[t].Condition,i.StatusTime=e[t].UpdatedTime,i.Schedule=e[t].CleaningSchedule,i.ItemScheduleId=e[t].ItemScheduleId,eviivo.component.listing.refreshRow(f,o)}$("#loading-overlay").hide(),u(C.resources.GenericSave),eviivo.component.listing.filter.updateColumnFilter(f,f.columns().toArray()[0]),eviivo.component.flyout.hideAllFlyouts()},failCallback:function(e,t,o,i){$("#loading-overlay").hide(),d(C.resources.GenericError)}}))},initialiseOnChangeListeners:s})},7887:function(){function a(e,t){t=$("#".concat(e," th:eq(").concat(t,")")).attr("data-key");return $.each(n,function(){this.tableId.toLowerCase()==e.toLowerCase()&&(cachedTableColumnCodesMap=this.columnCodes)}),cachedTableColumnCodesMap[t]}var n,l,s,r;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.listingTable=window.eviivo.pms.listingTable||{},window.eviivo.pms.listingTable.filterActions=window.eviivo.pms.listingTable.filterActions||{},window.eviivo.pms.listingTable.filterActions=(n=[{tableId:"eviivo-list-rule",tableCode:"PRL",columnCodes:{PropertyName:"PRO",TypeCodeDescription:"RTY",Name:"RNA",RoomTypeName:"APP",ChannelsFilter:"CHA",Status:"STA",UpdateStatus:"UST"}},{tableId:"eviivo-list-cutoff",tableCode:"BCO",columnCodes:{PropertyName:"BPR",Description:"BCD",Status:"BST"}},{tableId:"eviivo-list-cleaning",tableCode:"CLN",columnCodes:{Unit:"CRO",Movement:"CMO",Condition:"CCO",Schedule:"CSH",Assigned:"CAT",BedConfig:"CBE",Property:"CPR"}},{tableId:"eviivo-list-charge",tableCode:"GCH",columnCodes:{PropertyName:"GPR",Name:"GCN",CategoryName:"GCA",DisplayOnline:"GDO",CollectionMethodDisplay:"GCO"}},{tableId:"eviivo-list-ownercharge",tableCode:"OCH",columnCodes:{PropertyName:"OPR",Name:"OCN",CategoryName:"OCA"}},{tableId:"eviivo-list-deductions",tableCode:"DED",columnCodes:{BusinessName:"DEP",Name:"DEN",Category:"DEC",Apply:"DEA",Pricing:"DDP"}},{tableId:"eviivo-list-categories",tableCode:"CCA",columnCodes:{BusinessName:"CCP",Category:"CCC",Code:"CCO",AssociatedTemplates:"CCA"}},{tableId:"eviivo-list-promotion",tableCode:"PRO",columnCodes:{BusinessName:"PRP",Name:"PPR",Type:"PRT",DiscountRules:"PDI",BookingWindow:"PWI",Status:"PST"}},{tableId:"eviivo-list-ratemap",tableCode:"RML",columnCodes:{BusinessName:"RMP",RoomTypeName:"RMR",RatePlanName:"RRP",Status:"RMS",Guests:"RMC",MaxAdults:"RMA",MaxChildren:"RMK",BoardBasis:"RMB",Cancellation:"RMN",Deposit:"RMD",Channels:"RMH"}},{tableId:"eviivo-list-reports",tableCode:"DRT",columnCodes:{Name:"DRN"}},{tableId:"eviivo-list-rateplans",tableCode:"CRS",columnCodes:{Status:"CRS",Channels:"CRC",RoomType:"CRR",RatePlan:"CRP",Notes:"CRN"}},{tableId:"eviivo-list-emails",tableCode:"MTL",columnCodes:{PropertyName:"MTP",GuestCycle:"MTC",EmailType:"MTT",Description:"MTD",Schedule:"MTS",Status:"MTA"}},{tableId:"eviivo-list-headers",tableCode:"HML",columnCodes:{PropertyName:"HPC",Universal:"HUC",HomePage:"HHC",WebPage:"HWC",Emails:"HEC",Invoice:"HIC",GuestRegistration:"HGC"}},{tableId:"eviivo-list-bookings",tableCode:"ATL",columnCodes:{BusinessName:"ATP",GuestSurname:"ATG",RoomName:"ATR",NumberOfNights:"ATN",Source:"ATS",IsMarkedBool:"ATH"}},{tableId:"eviivo-list-agreementtemplate",tableCode:"ATT",columnCodes:{TemplateName:"ATN",AppliesTo:"ATA"}},{tableId:"eviivo-list-agreement",tableCode:"AGT",columnCodes:{PropertyName:"AGP",AgreementDisplayName:"AGN",SignatureFirstName:"AGF",SignatureSurname:"AGS",OrderReference:"AGO",OrderCheckInPropertyDate:"AGC",AgreementSentPropertyDateTime:"AGS",SignaturePropertyDateTime:"AGX",Status:"AGA"}}],l=[],s="ATL",r="ATH",{init:function(e){var t,o,i,a;i=e.table,$.each(n,function(){this.tableId.toLowerCase()==i.toLowerCase()&&(a=this.tableCode)}),t=a,o=e.callback,eviivo.webcore.ajaxHelper.executeAjax({actionId:"get-listingtable-filter-data-".concat(t),url:"".concat(eviivoSuiteApp,"/api/UserPreferenceListingTableFilterActions/get?tableCode=").concat(t),method:eviivo.webcore.ajaxHelper.methods.GET,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){l=l.concat(e),(e=t)==s&&(null==(e=null==(e=l)?void 0:e.filter(function(e){return e.Key==r}))||0==e.length?l.push({PreferenceGroupType:s,Key:r,Value:'["false"]'}):null!=e&&"[]"==e[0].Value&&(e[0].Value='["false"]')),o()},failCallback:function(){o()}})},get:function(e,t){var o=a(e,t),i=null;return $.each(l,function(){this.Key==o&&(i=this.Value)}),null==i?"":(i=i.replaceAll("&quot;",'"'),JSON.parse(i))},post:function(e,t){var e=e.parents("table").attr("id"),o=eviivo.component.listing.filter.getColumnSearchStrings(e,t),e=a(e,t);eviivo.webcore.ajaxHelper.executeAjax({actionId:"post-listingtable-filter-".concat(e),url:"".concat(eviivoSuiteApp,"/api/UserPreferenceListingTableFilterActions/post"),data:{ColumnCode:e,ColumnFilter:JSON.stringify(o)},method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){}})}})},1452:function(){var n,l;window.eviivo=window.eviivo||{},window.eviivo.pms=window.eviivo.pms||{},window.eviivo.pms.listingTable=window.eviivo.pms.listingTable||{},window.eviivo.pms.listingTable.orderActions=window.eviivo.pms.listingTable.orderActions||{},window.eviivo.pms.listingTable.orderActions=(n=[{tableId:"eviivo-list-rule",Order:"SRT"},{tableId:"eviivo-list-cutoff",Order:"BOR"},{tableId:"eviivo-list-cleaning",Order:"COR"},{tableId:"eviivo-list-charge",Order:"GOR"},{tableId:"eviivo-list-ownercharge",Order:"OOR"},{tableId:"eviivo-list-deductions",Order:"DEO"},{tableId:"eviivo-list-categories",Order:"CCS"},{tableId:"eviivo-list-promotion",Order:"POR"},{tableId:"eviivo-list-ratemap",Order:"RMO"},{tableId:"eviivo-list-reports",Order:"DRO"},{tableId:"eviivo-list-rateplans",Order:"RSO"},{tableId:"eviivo-list-emails",Order:"MTO"},{tableId:"eviivo-list-headers",Order:"HLO"},{tableId:"eviivo-list-bookings",Order:"ATO"},{tableId:"eviivo-list-agreementtemplate",Order:"ATD"},{tableId:"eviivo-list-agreement",Order:"AGD"}],l={},{post:function(e,t){var o,i,a=eviivo.util.getJSId($(this)[0].container);null!=a&&null!=t&&isNaN(t)&&(t={ColumnCode:(o=a,$.each(n,function(){this.tableId.toLowerCase()==o.toLowerCase()&&(i=this.Order)}),i),Order:JSON.stringify(t)})!=l&&(l=t,eviivo.webcore.ajaxHelper.executeAjax({actionId:"post-listingtable-order",url:"".concat(eviivoSuiteApp,"/api/UserPreferenceListingTableFilterActions/order-post"),data:t,method:eviivo.webcore.ajaxHelper.methods.POST,contentType:eviivo.webcore.ajaxHelper.contentTypes.APPLICATION_JSON_UTF8,dataType:eviivo.webcore.ajaxHelper.dataTypes.JSON,callback:function(e){}}))}})}},i={};function a(e){var t=i[e];return void 0!==t||(t=i[e]={exports:{}},o[e](t,t.exports,a)),t.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";a(4301),a(8211),a(7887),a(1452)}();
//# sourceMappingURL=cleaning.min.js.map